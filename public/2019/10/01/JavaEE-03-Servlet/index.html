

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="内容可能较多，包括Servlet，Jsp，Maven，html，Js等内容">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaEE 03 JavaWeb基础(Servlet)">
<meta property="og:url" content="http://example.com/2019/10/01/JavaEE-03-Servlet/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="内容可能较多，包括Servlet，Jsp，Maven，html，Js等内容">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_01.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_02.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_03.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_04.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_05.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_06.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_07.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_08.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_09.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_10.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_11.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_12.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_13.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_14.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_15.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_16.png">
<meta property="og:image" content="http://example.com/assets/JavaEE/javaweb_17.png">
<meta property="article:published_time" content="2019-10-01T13:37:03.000Z">
<meta property="article:modified_time" content="2023-06-04T11:59:43.076Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="JavaEE">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/assets/JavaEE/javaweb_01.png">
  
  
  
  <title>JavaEE 03 JavaWeb基础(Servlet) - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="JavaEE 03 JavaWeb基础(Servlet)"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2019-10-01 21:37" pubdate>
          2019年10月1日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          59k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          489 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">JavaEE 03 JavaWeb基础(Servlet)</h1>
            
            
              <div class="markdown-body">
                
                <p>内容可能较多，包括Servlet，Jsp，Maven，html，Js等内容</p>
<span id="more"></span>

<h1 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Servlet是运行在web服务器或者是应用服务器上的应用程序。它是作为web浏览器或者其他Http客户端请求和Http服务器上数据库或应用程序之间的中间件。<br>Servlet的架构图如下所示：<br><img src="/assets/JavaEE/javaweb_01.png" srcset="/img/loading.gif" lazyload alt="Servlet架构图"></p>
<p>Servlet的任务主要包括以下几个内容：</p>
<ol>
<li>读取客户端发送的显式数据，包括网页上的表单，或者是applet或自定义Http客户端程序的表单</li>
<li>读取客户端发送的隐式数据，包括cookie，媒体类型，浏览器能理解的压缩格式</li>
<li>处理数据并产生结果，这个过程可能要访问数据库，执行RMI或CORBA调用，调用web服务，或直接计算出对应的响应。</li>
<li>发送显式数据(即文档)到客户端，该文档的样式是多样性的，可以是文本文件(HTML,XML),二进制文件(git图像)，Excel</li>
<li>发送隐式HTTP响应到客户端，包括返回的文档类型，设置cookie和缓存参数，以及其他类似任务。</li>
</ol>
<p>实现Servlet的方式有三种</p>
<h4 id="实现Serlvet接口"><a href="#实现Serlvet接口" class="headerlink" title="实现Serlvet接口"></a>实现Serlvet接口</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//Servlet的生命周期:从Servlet被创建到Servlet被销毁的过程</span><br><span class="hljs-comment">//一次创建，到处服务</span><br><span class="hljs-comment">//一个Servlet只会有一个对象，服务所有的请求</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * 1.实例化（使用构造方法创建对象）</span><br><span class="hljs-comment"> * 2.初始化  执行init方法</span><br><span class="hljs-comment"> * 3.服务     执行service方法</span><br><span class="hljs-comment"> * 4.销毁    执行destroy方法</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ServletDemo1</span> <span class="hljs-title">implements</span> <span class="hljs-title">Servlet</span> &#123;<br><br>    <span class="hljs-comment">//public ServletDemo1()&#123;&#125;</span><br><br>     <span class="hljs-comment">//生命周期方法:当Servlet第一次被创建对象时执行该方法,该方法在整个生命周期中只执行一次</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span>(<span class="hljs-params">ServletConfig arg0</span>) throws ServletException</span> &#123;<br>                System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;=======init=========&quot;</span>);<br>        &#125;<br><br>    <span class="hljs-comment">//生命周期方法:对客户端响应的方法,该方法会被执行多次，每次请求该servlet都会执行该方法</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">service</span>(<span class="hljs-params">ServletRequest arg0, ServletResponse arg1</span>)</span><br><span class="hljs-function">            throws ServletException, IOException</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;hehe&quot;</span>);<br><br>    &#125;<br><br>    <span class="hljs-comment">//生命周期方法:当Servlet被销毁时执行该方法</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;******destroy**********&quot;</span>);<br>    &#125;<br><span class="hljs-comment">//当停止tomcat时也就销毁的servlet。</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ServletConfig <span class="hljs-title">getServletConfig</span>()</span> &#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getServletInfo</span>()</span> &#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="继承GenericServlet抽象类"><a href="#继承GenericServlet抽象类" class="headerlink" title="继承GenericServlet抽象类"></a>继承GenericServlet抽象类</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs scala">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServletDemo2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">GenericServlet</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    public void service(<span class="hljs-type">ServletRequest</span> arg0, <span class="hljs-type">ServletResponse</span> arg1)<br>            <span class="hljs-keyword">throws</span> <span class="hljs-type">ServletException</span>, <span class="hljs-type">IOException</span> &#123;<br>        <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;heihei&quot;</span>);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="继承HttpServlet抽象类"><a href="#继承HttpServlet抽象类" class="headerlink" title="继承HttpServlet抽象类"></a>继承HttpServlet抽象类</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs scala">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServletDemo3</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> void doGet(<span class="hljs-type">HttpServletRequest</span> req, <span class="hljs-type">HttpServletResponse</span> resp)<br>            <span class="hljs-keyword">throws</span> <span class="hljs-type">ServletException</span>, <span class="hljs-type">IOException</span> &#123;<br>        <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;haha&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> void doPost(<span class="hljs-type">HttpServletRequest</span> req, <span class="hljs-type">HttpServletResponse</span> resp)<br>            <span class="hljs-keyword">throws</span> <span class="hljs-type">ServletException</span>, <span class="hljs-type">IOException</span> &#123;<br>        <span class="hljs-type">System</span>.out.println(<span class="hljs-string">&quot;ee&quot;</span>);<br>        doGet(req,resp);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>一般情况下我们使用第三种方式的情况比较多</p>
<h4 id="三者之间的关系"><a href="#三者之间的关系" class="headerlink" title="三者之间的关系"></a>三者之间的关系</h4><p>关于 HttpServlet、GenericServlet 和 Servlet 的关系<br>对于一个 Servlet 类，我们日常最常用的方法是继承自 HttpServlet 类，提供了 Http 相关的方法，HttpServlet 扩展了 GenericServlet 类，而 GenericServlet 类又实现了 Servlet 类和 ServletConfig 类。</p>
<p>Servlet</p>
<p>Servlet 类提供了五个方法，其中三个生命周期方法和两个普通方法，关于 Servlet 类的方法，不再赘述，我主要补充一下另外两个类的实现思路。</p>
<p>GenericServlet</p>
<p>GenericServlet 是一个抽象类，实现了 Servlet 接口，并且对其中的 init() 和 destroy() 和 service() 提供了默认实现。在 GenericServlet 中，主要完成了以下任务：</p>
<ul>
<li>将 init() 中的 ServletConfig 赋给一个类级变量，可以由 getServletConfig 获得；</li>
<li>为 Servlet 所有方法提供默认实现；</li>
<li>可以直接调用 ServletConfig 中的方法；</li>
</ul>
<p>基本结构如下所示：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GenericServlet</span> <span class="hljs-title">implements</span> <span class="hljs-title">Servlet</span>,<span class="hljs-title">ServletConfig</span>&#123;<br> <br>   <span class="hljs-comment">//GenericServlet通过将ServletConfig赋给类级变量</span><br>   <span class="hljs-keyword">private</span> trServletConfig servletConfig;<br> <br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span>(<span class="hljs-params">ServletConfig servletConfig</span>) throws ServletException</span> &#123;<br><br>      <span class="hljs-keyword">this</span>.servletConfig=servletConfig;<br><br>      <span class="hljs-comment">/*自定义init()的原因是：如果子类要初始化必须覆盖父类的init() 而使它无效 这样</span><br><span class="hljs-comment">       this.servletConfig=servletConfig不起作用 这样就会导致空指针异常 这样如果子类要初始化，</span><br><span class="hljs-comment">       可以直接覆盖不带参数的init()方法 */</span><br>      <span class="hljs-keyword">this</span>.<span class="hljs-keyword">init</span>();<br>   &#125;<br>   <br>   <span class="hljs-comment">//自定义的init()方法，可以由子类覆盖  </span><br>   <span class="hljs-comment">//init()不是生命周期方法</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span>()</span>&#123;<br>  <br>   &#125;<br> <br>   <span class="hljs-comment">//实现service()空方法，并且声明为抽象方法，强制子类必须实现service()方法 </span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">service</span>(<span class="hljs-params">ServletRequest request,ServletResponse response</span>) </span><br><span class="hljs-function">     throws ServletException,java.io.IOException</span>&#123;<br>   &#125;<br> <br>   <span class="hljs-comment">//实现空的destroy方法</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span>()</span>&#123; &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>HttpServlet</p>
<p>HttpServlet 也是一个抽象类，它进一步继承并封装了 GenericServlet，使得使用更加简单方便，由于是扩展了 Http 的内容，所以还需要使用 HttpServletRequest 和 HttpServletResponse，这两个类分别是 ServletRequest 和 ServletResponse 的子类。代码如下：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">GenericServlet</span></span>&#123;<br> <br>   <span class="hljs-comment">//HttpServlet中的service()</span><br>   <span class="hljs-keyword">protected</span> void service(<span class="hljs-type">HttpServletRequest</span> httpServletRequest,<br>                       <span class="hljs-type">HttpServletResponse</span> httpServletResponse)&#123;<br>        <span class="hljs-comment">//该方法通过httpServletRequest.getMethod()判断请求类型调用doGet() doPost()</span><br>   &#125;<br> <br>   <span class="hljs-comment">//必须实现父类的service()方法</span><br>   public void service(<span class="hljs-type">ServletRequest</span> servletRequest,<span class="hljs-type">ServletResponse</span> servletResponse)&#123;<br>      <span class="hljs-type">HttpServletRequest</span> request;<br>      <span class="hljs-type">HttpServletResponse</span> response;<br>      <span class="hljs-keyword">try</span>&#123;<br>         request=(<span class="hljs-type">HttpServletRequest</span>)servletRequest;<br>         response=(<span class="hljs-type">HttpServletResponse</span>)servletResponse;<br>      &#125;<span class="hljs-keyword">catch</span>(<span class="hljs-type">ClassCastException</span>)&#123;<br>         <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-type">ServletException</span>(<span class="hljs-string">&quot;non-http request or response&quot;</span>);<br>      &#125;<br>      <span class="hljs-comment">//调用service()方法</span><br>      <span class="hljs-keyword">this</span>.service(request,response);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们可以看到，HttpServlet 中对原始的 Servlet 中的方法都进行了默认的操作，不需要显式的销毁初始化以及 service()，在 HttpServlet 中，自定义了一个新的 service() 方法，其中通过 getMethod() 方法判断请求的类型，从而调用 doGet() 或者 doPost() 处理 get,post 请求，使用者只需要继承 HttpServlet，然后重写 doPost() 或者 doGet() 方法处理请求即可。</p>
<p>我们一般都使用继承 HttpServlet 的方式来定义一个 servlet。</p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>Servlet是服务HTTP请求并实现了Servlet接口的类，Web 应用程序开发人员通常编写 Servlet 来扩展 javax.servlet.http.HttpServlet，并实现 Servlet 接口的抽象类专门用来处理 HTTP 请求。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.paulniu.dao;<br><br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.PrintWriter;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * author:niupuyue</span><br><span class="hljs-comment"> * date: 2019/10/9</span><br><span class="hljs-comment"> * time: 22:51</span><br><span class="hljs-comment"> * version:</span><br><span class="hljs-comment"> * desc:</span><br><span class="hljs-comment"> **/</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FirstServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HttpServlet</span> &#123;<br><br>    <span class="hljs-keyword">private</span> String message;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ServletException &#123;<br>        message = <span class="hljs-string">&quot;初始化FirstServlet&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doPost</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doGet</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>        <span class="hljs-comment">// 设置响应内容</span><br>        response.setContentType(<span class="hljs-string">&quot;text/html&quot;</span>);<br>        <span class="hljs-type">PrintWriter</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> response.getWriter();<br>        out.write(<span class="hljs-string">&quot;&lt;h1&gt; &quot;</span> + message + <span class="hljs-string">&quot; &lt;/h1&gt;&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destory</span><span class="hljs-params">()</span>&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<p>看一下map</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;4.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>FirstServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.paulniu.dao.FirstServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>FirstServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/first<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>补充说明：<br>destory方法被调用后，servlet被销毁，但是并没有立即回收，再次请求时，并没有重新初始化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> String message;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ServletException &#123;<br>    message = <span class="hljs-string">&quot;Hello World , Nect To Meet You: &quot;</span> + System.currentTimeMillis();<br>    System.out.println(<span class="hljs-string">&quot;servlet初始化……&quot;</span>);<br>    <span class="hljs-built_in">super</span>.init();<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>    response.setContentType(<span class="hljs-string">&quot;text/html&quot;</span>);<br>    <span class="hljs-type">PrintWriter</span> <span class="hljs-variable">writer</span> <span class="hljs-operator">=</span> response.getWriter();<br>    writer.write(<span class="hljs-string">&quot;&lt;h1&gt;&quot;</span> + message + <span class="hljs-string">&quot;&lt;/h1&gt;&quot;</span>);<br>    destroy();<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    <span class="hljs-built_in">super</span>.doPost(req, resp);<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;servlet销毁！&quot;</span>);<br>    <span class="hljs-built_in">super</span>.destroy();<br>&#125;<br></code></pre></td></tr></table></figure>
<p>Log日志打印：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs stylus">servlet初始化……<br>servlet销毁！<br><span class="hljs-number">2017</span>-<span class="hljs-number">7</span>-<span class="hljs-number">6</span> <span class="hljs-number">19</span>:<span class="hljs-number">48</span>:<span class="hljs-number">52</span> org<span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.catalina</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.StandardContext</span> reload<br>信息: Reloading Context with name <span class="hljs-selector-attr">[/myServlet]</span> has started<br>servlet销毁！<br><span class="hljs-number">2017</span>-<span class="hljs-number">7</span>-<span class="hljs-number">6</span> <span class="hljs-number">19</span>:<span class="hljs-number">48</span>:<span class="hljs-number">52</span> org<span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.catalina</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.StandardContext</span> reload<br>信息: Reloading Context with name <span class="hljs-selector-attr">[/myServlet]</span> is completed<br>servlet初始化……<br>servlet销毁！<br>servlet销毁！<br>servlet销毁！<br>servlet销毁！<br>servlet销毁！<br>servlet销毁！<br>servlet销毁！<br></code></pre></td></tr></table></figure>

<p>Servlet浏览器访问路径配置的小问题<br>有两种方式配置路径</p>
<ul>
<li>java 类里的注解 —— @WebServlet(“&#x2F;HelloServlet”) 对应浏览器路径<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">8080</span><span class="hljs-regexp">/TomcatTest/</span>HelloServlet<br></code></pre></td></tr></table></figure></li>
<li>配置文件（web.xml）里对应的浏览器访问路径：<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">8080</span><span class="hljs-regexp">/TomcatTest/</span>TomcatTest/HelloServlet<br></code></pre></td></tr></table></figure>
两种配置使用一种即可，不然路径重名反而会让tomcat启动不了</li>
</ul>
<h2 id="Servlet生命周期"><a href="#Servlet生命周期" class="headerlink" title="Servlet生命周期"></a>Servlet生命周期</h2><p>Servlet生命周期可被定义为冲创建知道毁灭的过程，遵循以下过程</p>
<ol>
<li>Servlet通过调用init()方法进行初始化</li>
<li>Servlet调用service()方法来处理客户端请求</li>
<li>Servlet通过调用destory()方法终止(结束)</li>
<li>最后Servlet是由JVM的垃圾回收器进行垃圾回收的</li>
</ol>
<h3 id="init-方法"><a href="#init-方法" class="headerlink" title="init()方法"></a>init()方法</h3><p>init方法被设计成只调用一次，在第一次创建该Servlet时被调用，在后续每次用户请求时不再调用，因此它是用一次性初始化<br>Servlet创建于用户第一次调用欧冠对象与该Servlet的URL时，但是我们也可以指定Servlet在服务器第一次启动时被加载。当用户调用Servlet时，创建一个Servlet实例，每一个用户请求都会产生新的线程，适当的时候交给doGet或者doPost方法。init方法简单的创建或加载一些数据，这些数据将被用于Servlet的整个生命周期<br>init方法的定义如下</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ServletException</span>&#123;<br>    <span class="hljs-comment">// 初始化代码</span><br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="service-方法"><a href="#service-方法" class="headerlink" title="service()方法"></a>service()方法</h3><p>service()方法是执行实际任务的主要方法.Servlet容器(即Web服务器)调用service()方法来处理来自客户端浏览器的请求，并把格式化的响应写回给客户端<br>每次服务器接收到一个Servlet请求时，服务器会产生一个新的线程并调用服务。service()方法检查HTTP请求类型(GET,POST,PUT,DELETE等)，并在适当的时候调用相应的方法</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">service</span><span class="hljs-params">(ServletRequest request, </span></span><br><span class="hljs-params"><span class="hljs-function">                    ServletResponse response)</span> </span><br><span class="hljs-function">      <span class="hljs-keyword">throws</span> ServletException, IOException</span>&#123;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>service()方法由容器调用，service方法在适当的时侯调用doGet,doPost,doPut,doDelete等方法，所以，不用对service()方法做任何动作，只需要根据来自客户端的请求类型重写相应的方法即可<br>doGet和doPost方法是每次服务请求中最常用的方法，</p>
<h4 id="doGet-方法"><a href="#doGet-方法" class="headerlink" title="doGet()方法"></a>doGet()方法</h4><p>GET 请求来自于一个 URL 的正常请求，或者来自于一个未指定 METHOD 的 HTML 表单，它由 doGet() 方法处理。</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest request,</span></span><br><span class="hljs-params"><span class="hljs-function">                  HttpServletResponse response)</span></span><br><span class="hljs-function">    <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>    <span class="hljs-comment">// Servlet 代码</span><br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="doPost-方法"><a href="#doPost-方法" class="headerlink" title="doPost()方法"></a>doPost()方法</h4><p>POST 请求来自于一个特别指定了 METHOD 为 POST 的 HTML 表单，它由 doPost() 方法处理。</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest request,</span></span><br><span class="hljs-params"><span class="hljs-function">                   HttpServletResponse response)</span></span><br><span class="hljs-function">    <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>    <span class="hljs-comment">// Servlet 代码</span><br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="destory-方法"><a href="#destory-方法" class="headerlink" title="destory()方法"></a>destory()方法</h3><p>destroy() 方法只会被调用一次，在 Servlet 生命周期结束时被调用。destroy() 方法可以让您的 Servlet 关闭数据库连接、停止后台线程、把 Cookie 列表或点击计数器写入到磁盘，并执行其他类似的清理活动。</p>
<p>在调用 destroy() 方法之后，servlet 对象被标记为垃圾回收。destroy 方法定义如下所示：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span>()</span> &#123;<br>  <span class="hljs-comment">// 终止化代码...</span><br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="架构图"><a href="#架构图" class="headerlink" title="架构图"></a>架构图</h3><p><img src="/assets/JavaEE/javaweb_02.png" srcset="/img/loading.gif" lazyload alt="Servlet生命周期架构图">  </p>
<h2 id="表单数据"><a href="#表单数据" class="headerlink" title="表单数据"></a>表单数据</h2><p>在我们的开发过程中表单是非常常用的一个组件，不管是登录也好，还是搜索，等等。浏览器使用两种方法可将表单信息传递给web服务器，分别是GET和POST<br>GET方法是默认的从浏览器向web服务器传递信息的方法，它会产生一个很长的字符串，并且出现在浏览器的地址栏中。如果我们想要传递一些比较敏感的信息，不要使用GET方法，并且GET方法对字符串大小也有限制，请求字符串中最多只能有1024个字符<br>POST方法是向后台传递信息比较可靠的方法。POST方法打包信息的方式与GET方法基本相同。但是POST方法不是吧信息直接放在URL的文本字符串发送，而是将这些信息作为一个单独的消息进行传递。消息以标准输出的形式传到后台程序。</p>
<p>使用Servlet读取表单数据，这些数据会根据不同的情况使用不同的方法自动解析：</p>
<ol>
<li>getParameter():可以调用request.getParameter()方法来获取表单参数的值</li>
<li>getParameterValues():如果参数出现一次以上，则调用该方法，并且返回多个值，比如复选框</li>
<li>getParameterNames():如果想要得到当前请求中的所有参数的完整列表，则调用该方法</li>
</ol>
<p>一个例子：</p>
<figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs wren"><span class="hljs-variable">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginServlet</span> <span class="hljs-variable">extends</span> <span class="hljs-title class_">HttpServlet</span> &#123;<br><br>    @<span class="hljs-title class_">Override</span><br>    <span class="hljs-variable">protected</span> <span class="hljs-variable">void</span> <span class="hljs-title function_">doGet</span>(<span class="hljs-title class_">HttpServletRequest</span> <span class="hljs-variable">req</span>, <span class="hljs-title class_">HttpServletResponse</span> <span class="hljs-variable">resp</span>) <span class="hljs-variable">throws</span> <span class="hljs-title class_">ServletException</span>, <span class="hljs-title class_">IOException</span> &#123;<br>        <span class="hljs-variable">resp</span>.<span class="hljs-property">setContentType</span>(<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span>);<br>        <span class="hljs-title class_">PrintWriter</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> <span class="hljs-variable">resp</span>.<span class="hljs-property">getWriter</span>();<br>        <span class="hljs-title class_">String</span> <span class="hljs-variable">title</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;使用get方法读取表单内容&quot;</span>;<br><br>        <span class="hljs-title class_">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-variable">req</span>.<span class="hljs-property">getParameter</span>(<span class="hljs-string">&quot;inputEmail&quot;</span>);<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-property">println</span>(<span class="hljs-variable">name</span>);<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-property">println</span>(<span class="hljs-variable">req</span>.<span class="hljs-property">getParameter</span>(<span class="hljs-string">&quot;inputEmail&quot;</span>));<br>        <span class="hljs-title class_">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-variable">req</span>.<span class="hljs-property">getParameter</span>(<span class="hljs-string">&quot;inputPassword&quot;</span>);<br>        <span class="hljs-title class_">String</span> <span class="hljs-variable">remember</span> <span class="hljs-operator">=</span> <span class="hljs-variable">req</span>.<span class="hljs-property">getParameter</span>(<span class="hljs-string">&quot;remember&quot;</span>);<br><br>        <span class="hljs-title class_">String</span> <span class="hljs-variable">docType</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&lt;!DOCTYPE html&gt; <span class="hljs-char escape_">\n</span>&quot;</span>;<br>        <span class="hljs-variable">out</span>.<span class="hljs-property">println</span>(<span class="hljs-variable">docType</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;html&gt; <span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;head&gt;&lt;title&gt;&quot;</span> <span class="hljs-operator">+</span> <span class="hljs-variable">title</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;&lt;/title&gt;&lt;/head&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;body bgcolor=<span class="hljs-char escape_">\&quot;</span>#f0f0f0<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;h1 align=<span class="hljs-char escape_">\&quot;</span>center<span class="hljs-char escape_">\&quot;</span>&gt;&quot;</span> <span class="hljs-operator">+</span> <span class="hljs-variable">title</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;&lt;/h1&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;ul&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;  &lt;li&gt;&lt;b&gt;姓名&lt;/b&gt;：&quot;</span><br>                <span class="hljs-operator">+</span> <span class="hljs-variable">name</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;  &lt;li&gt;&lt;b&gt;密码&lt;/b&gt;：&quot;</span><br>                <span class="hljs-operator">+</span> <span class="hljs-variable">password</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;  &lt;li&gt;&lt;b&gt;是否选择记住我&lt;/b&gt;: &quot;</span><br>                <span class="hljs-operator">+</span> <span class="hljs-variable">remember</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;/ul&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>);<br>        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-property">println</span>(<span class="hljs-title function_">getAllParameter</span>(<span class="hljs-variable">req</span>));<br>    &#125;<br><br>    @<span class="hljs-title class_">Override</span><br>    <span class="hljs-variable">protected</span> <span class="hljs-variable">void</span> <span class="hljs-title function_">doPost</span>(<span class="hljs-title class_">HttpServletRequest</span> <span class="hljs-variable">req</span>, <span class="hljs-title class_">HttpServletResponse</span> <span class="hljs-variable">resp</span>) <span class="hljs-variable">throws</span> <span class="hljs-title class_">ServletException</span>, <span class="hljs-title class_">IOException</span> &#123;<br>        <span class="hljs-variable">resp</span>.<span class="hljs-property">setContentType</span>(<span class="hljs-string">&quot;text/html&quot;</span>);<br>        <span class="hljs-title class_">PrintWriter</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> <span class="hljs-variable">resp</span>.<span class="hljs-property">getWriter</span>();<br>        <span class="hljs-title class_">String</span> <span class="hljs-variable">title</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;使用post方法读取表单内容&quot;</span>;<br><br>        <span class="hljs-title class_">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-variable">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-variable">req</span>.<span class="hljs-property">getParameter</span>(<span class="hljs-string">&quot;inputName&quot;</span>).<span class="hljs-property">getBytes</span>(<span class="hljs-string">&quot;ISO8859-1&quot;</span>), <span class="hljs-string">&quot;UTF-8&quot;</span>);<br>        <span class="hljs-title class_">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-variable">req</span>.<span class="hljs-property">getParameter</span>(<span class="hljs-string">&quot;inputPassword&quot;</span>);<br><br>        <span class="hljs-title class_">String</span> <span class="hljs-variable">docType</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&lt;!DOCTYPE html&gt; <span class="hljs-char escape_">\n</span>&quot;</span>;<br>        <span class="hljs-variable">out</span>.<span class="hljs-property">println</span>(<span class="hljs-variable">docType</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;html&gt; <span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;head&gt;&lt;title&gt;&quot;</span> <span class="hljs-operator">+</span> <span class="hljs-variable">title</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;&lt;/title&gt;&lt;/head&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;body bgcolor=<span class="hljs-char escape_">\&quot;</span>#f0f0f0<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;h1 align=<span class="hljs-char escape_">\&quot;</span>center<span class="hljs-char escape_">\&quot;</span>&gt;&quot;</span> <span class="hljs-operator">+</span> <span class="hljs-variable">title</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;&lt;/h1&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;ul&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;  &lt;li&gt;&lt;b&gt;姓名&lt;/b&gt;：&quot;</span><br>                <span class="hljs-operator">+</span> <span class="hljs-variable">name</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;  &lt;li&gt;&lt;b&gt;密码&lt;/b&gt;：&quot;</span><br>                <span class="hljs-operator">+</span> <span class="hljs-variable">password</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;/ul&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 获取所有的参数</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">private</span> <span class="hljs-title class_">HashMap</span><span class="hljs-operator">&lt;</span><span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span><span class="hljs-operator">&gt;</span> <span class="hljs-title function_">getAllParameter</span>(<span class="hljs-params">HttpServletRequest</span> <span class="hljs-params">request</span>) &#123;<br>        <span class="hljs-title class_">HashMap</span><span class="hljs-operator">&lt;</span><span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span><span class="hljs-operator">&gt;</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-variable">new</span> <span class="hljs-title class_">HashMap</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">&gt;</span>();<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">request</span> <span class="hljs-operator">==</span> <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">result</span>;<br>        &#125;<br>        <span class="hljs-title class_">Enumeration</span> <span class="hljs-variable">paramNames</span> <span class="hljs-operator">=</span> <span class="hljs-variable">request</span>.<span class="hljs-property">getParameterNames</span>();<br>        <span class="hljs-keyword">while</span> (<span class="hljs-variable">paramNames</span>.<span class="hljs-property">hasMoreElements</span>()) &#123;<br>            <span class="hljs-title class_">String</span> <span class="hljs-variable">paramName</span> <span class="hljs-operator">=</span> (<span class="hljs-title class_">String</span>) <span class="hljs-variable">paramNames</span>.<span class="hljs-property">nextElement</span>();<br>            <span class="hljs-title class_">String</span>[] <span class="hljs-variable">paramValues</span> <span class="hljs-operator">=</span> <span class="hljs-variable">request</span>.<span class="hljs-property">getParameterValues</span>(<span class="hljs-variable">paramName</span>);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">paramValues</span>.<span class="hljs-property">length</span> <span class="hljs-operator">==</span> <span class="hljs-number">1</span>) &#123;<br>                <span class="hljs-comment">// 只有一个数据，就去当前值</span><br>                <span class="hljs-title class_">String</span> <span class="hljs-variable">paramValue</span> <span class="hljs-operator">=</span> <span class="hljs-variable">paramValues</span>[<span class="hljs-number">0</span>];<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">paramValue</span>.<span class="hljs-property">length</span>() <span class="hljs-operator">==</span> <span class="hljs-number">0</span>) &#123;<br>                    <span class="hljs-comment">// 没有数据，不用执行</span><br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment">// 有数据，将key/value值写入到Map中</span><br>                    <span class="hljs-variable">result</span>.<span class="hljs-property">put</span>(<span class="hljs-variable">paramName</span>, <span class="hljs-variable">paramValue</span>);<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">// 读取到了多个值</span><br>                <span class="hljs-title class_">String</span> <span class="hljs-variable">paramVlue</span> <span class="hljs-operator">=</span> <span class="hljs-variable">paramValues</span>[<span class="hljs-variable">paramValues</span>.<span class="hljs-property">length</span> <span class="hljs-operator">-</span> <span class="hljs-number">1</span>];<br>                <span class="hljs-variable">result</span>.<span class="hljs-property">put</span>(<span class="hljs-variable">paramName</span>, <span class="hljs-variable">paramVlue</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">result</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>网页代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;bootstrap/css/bootstrap.min.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;jquery/jquery.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;bootstrap/js/bootstrap.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>表单<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-horizontal&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;login&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;get&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;control-group&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;control-label&quot;</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;inputEmail&quot;</span>&gt;</span>邮箱<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;controls&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;inputEmail&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;inputEmail&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;请输入邮箱&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;control-group&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;control-label&quot;</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;inputPassword&quot;</span>&gt;</span>密码<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;controls&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;inputPassword&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;inputPassword&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;请输入密码&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;control-group&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;controls&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;checkbox&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;remember&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span>&gt;</span> 记住我<br>                <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn&quot;</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="客户端HTTP请求"><a href="#客户端HTTP请求" class="headerlink" title="客户端HTTP请求"></a>客户端HTTP请求</h2><p>这里主要介绍在浏览器向后台发送HTTP请求的时候发送的是哪些参数<br>浏览器端重要的头信息：</p>
<table>
<thead>
<tr>
<th>头信息</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Accept</td>
<td>这个头信息指定浏览器或其他客户端可以处理的 MIME 类型。值 image&#x2F;png 或 image&#x2F;jpeg 是最常见的两种可能值</td>
</tr>
<tr>
<td>Accept-Charset</td>
<td>这个头信息指定浏览器可以用来显示信息的字符集。例如 ISO-8859-1。</td>
</tr>
<tr>
<td>Accept-Encoding</td>
<td>这个头信息指定浏览器知道如何处理的编码类型。值 gzip 或 compress 是最常见的两种可能值。</td>
</tr>
<tr>
<td>Accept-Language</td>
<td>这个头信息指定客户端的首选语言，在这种情况下，Servlet 会产生多种语言的结果。例如，en、en-us、ru 等。</td>
</tr>
<tr>
<td>Authorization</td>
<td>这个头信息用于客户端在访问受密码保护的网页时识别自己的身份。</td>
</tr>
<tr>
<td>Connection</td>
<td>这个头信息指示客户端是否可以处理持久 HTTP 连接。持久连接允许客户端或其他浏览器通过单个请求来检索多个文件。值 Keep-Alive 意味着使用了持续连接。</td>
</tr>
<tr>
<td>Content-Length</td>
<td>这个头信息只适用于 POST 请求，并给出 POST 数据的大小（以字节为单位）。</td>
</tr>
<tr>
<td>Cookie</td>
<td>这个头信息把之前发送到浏览器的 cookies 返回到服务器。</td>
</tr>
<tr>
<td>Host</td>
<td>这个头信息指定原始的 URL 中的主机和端口。</td>
</tr>
<tr>
<td>If-Modified-Since</td>
<td>这个头信息表示只有当页面在指定的日期后已更改时，客户端想要的页面。如果没有新的结果可以使用，服务器会发送一个 304 代码，表示 Not Modified 头信息。</td>
</tr>
<tr>
<td>If-Unmodified-Since</td>
<td>这个头信息是 If-Modified-Since 的对立面，它指定只有当文档早于指定日期时，操作才会成功。</td>
</tr>
<tr>
<td>Referer</td>
<td>这个头信息指示所指向的 Web 页的 URL。例如，如果您在网页 1，点击一个链接到网页 2，当浏览器请求网页 2 时，网页 1 的 URL 就会包含在 Referer 头信息中。</td>
</tr>
<tr>
<td>User-Agent</td>
<td>这个头信息识别发出请求的浏览器或其他客户端，并可以向不同类型的浏览器返回不同的内容。</td>
</tr>
</tbody></table>
<p>读取HTTP头的方法</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Cookie[] getCookies()</td>
<td>返回一个数组，包含客户端发送该请求的所有Cookie对象</td>
</tr>
<tr>
<td>Enumeration getAttributeNames()</td>
<td>返回一个枚举，包含提供给该请求可用的属性名称</td>
</tr>
<tr>
<td>Enumeration getHeaderNames()</td>
<td>返回一个枚举，包含在该请求中包含的所有的头名</td>
</tr>
<tr>
<td>Enumeration getParameterNames()</td>
<td>返回一个String对象的枚举，包含在该请求中包含的参数的名称</td>
</tr>
<tr>
<td>HttpSession getSession()</td>
<td>返回与该请求相关联的当前session会话，如果没有请求session会话，则会创建一个</td>
</tr>
<tr>
<td>HttpSession getSession(boolean create)</td>
<td>返回与该请求相关的当前HttpSession，或者如果没有当前会话，且创建时真的，则返回新建的session会话</td>
</tr>
<tr>
<td>Locale getLocale()</td>
<td>基于Accept-Language头，返回客户端接收内容的首选的区域设置</td>
</tr>
<tr>
<td>Object getAttribute(String name)</td>
<td>一对象形式返回已命名属性的值，如果没有给定名称的属性存在，则返回null</td>
</tr>
<tr>
<td>ServletInputStream getIputStream()</td>
<td>使用ServletInputStream，以二进制数形式检索请求的主体</td>
</tr>
<tr>
<td>String getAuthType()</td>
<td>返回用于保护Servlet的身份验证方案的名称，如”BASIC”或”SSL”，如果JSP没有收到保护则返回null</td>
</tr>
<tr>
<td>String getCharacterEncoding()</td>
<td>返回请求主体中使用的字符编码的名称</td>
</tr>
<tr>
<td>String getContentType()</td>
<td>返回请求主体MIME类型，如果不知道类型则返回null</td>
</tr>
<tr>
<td>String getContextPath()</td>
<td>返回指示请求上下文的请求URI部分</td>
</tr>
<tr>
<td>String getHeader(String name)</td>
<td>以字符串形式返回指定的请求头的值</td>
</tr>
<tr>
<td>String getMethod()</td>
<td>返回请求的HTTP方法额名称，例如GET，POST，PUT</td>
</tr>
<tr>
<td>String getParameter(String name)</td>
<td>以字符串形式返回请求参数的值，或者如果参数不存在则返回null</td>
</tr>
<tr>
<td>String getPathInfo()</td>
<td>当请求发出时，返回与客户端发送的URL相关的任何额外的路径信息</td>
</tr>
<tr>
<td>String getProtocol()</td>
<td>返回请求协议的名称和版本</td>
</tr>
<tr>
<td>String getQueryString()</td>
<td>返回包含在路径后的请求URL中查询字符串</td>
</tr>
<tr>
<td>String getRemoteAddr()</td>
<td>返回发送请求的客户端的互联网协议(IP)地址</td>
</tr>
<tr>
<td>String getRemoteHost()</td>
<td>返回发送请求的客户端的完全限定名称</td>
</tr>
<tr>
<td>String getRemoteUser()</td>
<td>如果用户已通过身份验证，则返回发出请求的登录用户，或者如果用户未通过身份验证，则返回null</td>
</tr>
<tr>
<td>String getRequestURI()</td>
<td>从协议名称知道HTTP请求的第一行的查询字符串中，返回该请求的URL的一部分</td>
</tr>
<tr>
<td>String getRequestedSessionId()</td>
<td>返回有客户端指定的session会话id</td>
</tr>
<tr>
<td>String getSevletPath()</td>
<td>返回调用JSP的请求的URL的一部分</td>
</tr>
<tr>
<td>String[] getParameterValues(String name)</td>
<td>返回一个字符串对象的数组，包含所有给定的请求参数的值，如果参数不存在则返回null</td>
</tr>
<tr>
<td>boolean isSecure()</td>
<td>返回一个布尔值，指示请求是否使用安全通道，如HTTPS</td>
</tr>
<tr>
<td>int getCountentLength()</td>
<td>以字节为单位返回请求主体的长度，并提供输入流，如果长度位置则返回-1</td>
</tr>
<tr>
<td>int getIntHeader(String name)</td>
<td>返回指定的请求头的值为一个int值</td>
</tr>
<tr>
<td>int getServerPort()</td>
<td>返回接收到这个请求的端口号</td>
</tr>
<tr>
<td>int getParameterMap()</td>
<td>将参数封装成Map类型</td>
</tr>
</tbody></table>
<p>例子：</p>
<figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs wren"><span class="hljs-variable">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HTTPServlet</span> <span class="hljs-variable">extends</span> <span class="hljs-title class_">HttpServlet</span> &#123;<br><br>    @<span class="hljs-title class_">Override</span><br>    <span class="hljs-variable">protected</span> <span class="hljs-variable">void</span> <span class="hljs-title function_">doGet</span>(<span class="hljs-title class_">HttpServletRequest</span> <span class="hljs-variable">request</span>, <span class="hljs-title class_">HttpServletResponse</span> <span class="hljs-variable">response</span>) <span class="hljs-variable">throws</span> <span class="hljs-title class_">ServletException</span>, <span class="hljs-title class_">IOException</span> &#123;<br><span class="hljs-comment">// 设置响应内容类型</span><br>        <span class="hljs-variable">response</span>.<span class="hljs-property">setContentType</span>(<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span>);<br><br>        <span class="hljs-title class_">PrintWriter</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> <span class="hljs-variable">response</span>.<span class="hljs-property">getWriter</span>();<br>        <span class="hljs-title class_">String</span> <span class="hljs-variable">title</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;HTTP Header 请求实例 &quot;</span>;<br>        <span class="hljs-title class_">String</span> <span class="hljs-variable">docType</span> <span class="hljs-operator">=</span><br>                <span class="hljs-string">&quot;&lt;!DOCTYPE html&gt; <span class="hljs-char escape_">\n</span>&quot;</span>;<br>        <span class="hljs-variable">out</span>.<span class="hljs-property">println</span>(<span class="hljs-variable">docType</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;html&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;head&gt;&lt;meta charset=<span class="hljs-char escape_">\&quot;</span>utf-8<span class="hljs-char escape_">\&quot;</span>&gt;&lt;title&gt;&quot;</span> <span class="hljs-operator">+</span> <span class="hljs-variable">title</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;&lt;/title&gt;&lt;/head&gt;<span class="hljs-char escape_">\n</span>&quot;</span><span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;body bgcolor=<span class="hljs-char escape_">\&quot;</span>#f0f0f0<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;h1 align=<span class="hljs-char escape_">\&quot;</span>center<span class="hljs-char escape_">\&quot;</span>&gt;&quot;</span> <span class="hljs-operator">+</span> <span class="hljs-variable">title</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;&lt;/h1&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;table width=<span class="hljs-char escape_">\&quot;</span>100%<span class="hljs-char escape_">\&quot;</span> border=<span class="hljs-char escape_">\&quot;</span>1<span class="hljs-char escape_">\&quot;</span> align=<span class="hljs-char escape_">\&quot;</span>center<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;tr bgcolor=<span class="hljs-char escape_">\&quot;</span>#949494<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span>&quot;</span> <span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;th&gt;Header 名称&lt;/th&gt;&lt;th&gt;Header 值&lt;/th&gt;<span class="hljs-char escape_">\n</span>&quot;</span><span class="hljs-operator">+</span><br>                <span class="hljs-string">&quot;&lt;/tr&gt;<span class="hljs-char escape_">\n</span>&quot;</span>);<br><br>        <span class="hljs-title class_">Enumeration</span> <span class="hljs-variable">headerNames</span> <span class="hljs-operator">=</span> <span class="hljs-variable">request</span>.<span class="hljs-property">getHeaderNames</span>();<br><br>        <span class="hljs-keyword">while</span>(<span class="hljs-variable">headerNames</span>.<span class="hljs-property">hasMoreElements</span>()) &#123;<br>            <span class="hljs-title class_">String</span> <span class="hljs-variable">paramName</span> <span class="hljs-operator">=</span> (<span class="hljs-title class_">String</span>)<span class="hljs-variable">headerNames</span>.<span class="hljs-property">nextElement</span>();<br>            <span class="hljs-variable">out</span>.<span class="hljs-property">print</span>(<span class="hljs-string">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span> <span class="hljs-operator">+</span> <span class="hljs-variable">paramName</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;&lt;/td&gt;<span class="hljs-char escape_">\n</span>&quot;</span>);<br>            <span class="hljs-title class_">String</span> <span class="hljs-variable">paramValue</span> <span class="hljs-operator">=</span> <span class="hljs-variable">request</span>.<span class="hljs-property">getHeader</span>(<span class="hljs-variable">paramName</span>);<br>            <span class="hljs-variable">out</span>.<span class="hljs-property">println</span>(<span class="hljs-string">&quot;&lt;td&gt; &quot;</span> <span class="hljs-operator">+</span> <span class="hljs-variable">paramValue</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;&lt;/td&gt;&lt;/tr&gt;<span class="hljs-char escape_">\n</span>&quot;</span>);<br>        &#125;<br>        <span class="hljs-variable">out</span>.<span class="hljs-property">println</span>(<span class="hljs-string">&quot;&lt;/table&gt;<span class="hljs-char escape_">\n</span>&lt;/body&gt;&lt;/html&gt;&quot;</span>);<br>    &#125;<br><br>    @<span class="hljs-title class_">Override</span><br>    <span class="hljs-variable">protected</span> <span class="hljs-variable">void</span> <span class="hljs-title function_">doPost</span>(<span class="hljs-title class_">HttpServletRequest</span> <span class="hljs-variable">req</span>, <span class="hljs-title class_">HttpServletResponse</span> <span class="hljs-variable">resp</span>) <span class="hljs-variable">throws</span> <span class="hljs-title class_">ServletException</span>, <span class="hljs-title class_">IOException</span> &#123;<br>        <span class="hljs-title function_">doGet</span>(<span class="hljs-variable">req</span>, <span class="hljs-variable">resp</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>网页代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;bootstrap/css/bootstrap.min.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;jquery/jquery.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;bootstrap/js/bootstrap.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-primary btn-danger&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;http&quot;</span>&gt;</span>发送请求<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p><img src="/assets/JavaEE/javaweb_03.png" srcset="/img/loading.gif" lazyload alt="Http请求header"></p>
<h2 id="客户端HTTP响应"><a href="#客户端HTTP响应" class="headerlink" title="客户端HTTP响应"></a>客户端HTTP响应</h2><p>和前面的你饿哦让一样，当一个web服务器响应一个HTTP请求时，响应通常包括一个状态行，一些响应报头，一个空行和文档。典型的如下所示</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml">HTTP/1.1 200 OK<br>Content-Type: text/html<br>Header2: ...<br>...<br>HeaderN: ...<br>  (Blank Line)<br><span class="hljs-meta">&lt;!doctype ...&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>...<br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>状态行包括HTTP版本(HTTP&#x2F;1.1)，一个状态码(200)和一个对应于状态码的短消息(OK)</p>
<p>下表总结了从Web服务器端返回到浏览器的最有用的HTTP1.1响应报头，我们可能会在开发中频繁使用:</p>
<table>
<thead>
<tr>
<th>头信息</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Allow</td>
<td>这个头信息指定服务器支持的请求方法（GET、POST 等）。</td>
</tr>
<tr>
<td>Cache-Control</td>
<td>这个头信息指定响应文档在何种情况下可以安全地缓存。可能的值有：public、private 或 no-cache 等。Public 意味着文档是可缓存，Private 意味着文档是单个用户私用文档，且只能存储在私有（非共享）缓存中，no-cache 意味着文档不应被缓存。</td>
</tr>
<tr>
<td>Connection</td>
<td>这个头信息指示浏览器是否使用持久 HTTP 连接。值 close 指示浏览器不使用持久 HTTP 连接，值 keep-alive 意味着使用持久连接。</td>
</tr>
<tr>
<td>Content-Disposition</td>
<td>这个头信息可以让您请求浏览器要求用户以给定名称的文件把响应保存到磁盘。</td>
</tr>
<tr>
<td>Content-Encoding</td>
<td>在传输过程中，这个头信息指定页面的编码方式。</td>
</tr>
<tr>
<td>Content-Language</td>
<td>这个头信息表示文档编写所使用的语言。例如，en、en-us、ru 等。</td>
</tr>
<tr>
<td>Content-Length</td>
<td>这个头信息指示响应中的字节数。只有当浏览器使用持久（keep-alive）HTTP 连接时才需要这些信息。</td>
</tr>
<tr>
<td>Content-Type</td>
<td>这个头信息提供了响应文档的 MIME（Multipurpose Internet Mail Extension）类型。</td>
</tr>
<tr>
<td>Expires</td>
<td>这个头信息指定内容过期的时间，在这之后内容不再被缓存。</td>
</tr>
<tr>
<td>Last-Modified</td>
<td>这个头信息指示文档的最后修改时间。然后，客户端可以缓存文件，并在以后的请求中通过 If-Modified-Since 请求头信息提供一个日期。</td>
</tr>
<tr>
<td>Location</td>
<td>这个头信息应被包含在所有的带有状态码的响应中。在 300s 内，这会通知浏览器文档的地址。浏览器会自动重新连接到这个位置，并获取新的文档。</td>
</tr>
<tr>
<td>Refresh</td>
<td>这个头信息指定浏览器应该如何尽快请求更新的页面。您可以指定页面刷新的秒数。</td>
</tr>
<tr>
<td>Retry-After</td>
<td>这个头信息可以与 503（Service Unavailable 服务不可用）响应配合使用，这会告诉客户端多久就可以重复它的请求。</td>
</tr>
<tr>
<td>Set-Cookie</td>
<td>这个头信息指定一个与页面关联的 cookie。</td>
</tr>
</tbody></table>
<p>设置HTTP响应报头的方法<br>这些方法可用于在Servlet程序中设置HTTP响应报头，通过HttpServletResponse对象可用</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>String encodeRedorectURL(String url)</td>
<td>为sendRedirect方法中使用的指定的URL进行编码，或者如果编码不是必须的，则返回URL未改变</td>
</tr>
<tr>
<td>String encodeURL(String url)</td>
<td>对包含session会话ID的指定URL编码，或者如果编码不是必须的，则返回URL未改变</td>
</tr>
<tr>
<td>boolean containsHeader(String name)</td>
<td>返回一个布尔值，指示是否已经设置已命名的相应报头</td>
</tr>
<tr>
<td>boolean isCommitted()</td>
<td>返回一个布尔值，指示响应是否已经提交</td>
</tr>
<tr>
<td>void addCookie(Cookie coookie)</td>
<td>把置顶的cookie添加到响应</td>
</tr>
<tr>
<td>void addHeader(String name,String value)</td>
<td>添加一个带有给定的名称和值的响应报头</td>
</tr>
<tr>
<td>void addDateHeader(String name,long date)</td>
<td>添加一个带有给定名称和日期值的响应报头</td>
</tr>
<tr>
<td>void addIntHeader(String name,int value)</td>
<td>添加一个带有给定名称和整数值的响应报头</td>
</tr>
<tr>
<td>void flushBuffer()</td>
<td>强制任何在缓冲区中的内容被写入到客户端</td>
</tr>
<tr>
<td>void reset()</td>
<td>清除缓冲区中存在的任何数据，包括状态码和头</td>
</tr>
<tr>
<td>void resetBuffer()</td>
<td>清除响应中基础缓存区的内容，不清除状态码和头</td>
</tr>
<tr>
<td>void sendError(int sc)</td>
<td>使用指定的状态码发送错误响应到客户端，并清除缓冲区</td>
</tr>
<tr>
<td>void sendError(int sc,String msg)</td>
<td>使用指定的状态发送错误响应到客户端</td>
</tr>
<tr>
<td>void sendRedirect(String location)</td>
<td>使用指定的重定向位置URL发送临时重定向响应到客户端</td>
</tr>
<tr>
<td>void setBufferSize(int size)</td>
<td>为响应主体设置首选的缓冲区大小</td>
</tr>
<tr>
<td>void setCharacterEncoding(String charset)</td>
<td>设置被发送到客户端的响应的字符编码(MIME字符集),例如UTF-8</td>
</tr>
<tr>
<td>void setContentLength(int len)</td>
<td>设置在HTTPServlet响应中内容主体的长度，该方法设置HTTP content-Length头</td>
</tr>
<tr>
<td>void setContentType(String type)</td>
<td>如果响应还未被提交，设置被发送到客户端的响应内容的类型</td>
</tr>
<tr>
<td>void setDateHeader(String name,long date)</td>
<td>设置一个带有给定名称和日期值的响应报头</td>
</tr>
<tr>
<td>void setHeader(String name,String value)</td>
<td>设置一个带有给定名称和值的响应报头</td>
</tr>
<tr>
<td>void setIntHeader(String name,int value)</td>
<td>设置一个带有给定的名称和整数值的响应报头</td>
</tr>
<tr>
<td>void setLocale(Locale loc)</td>
<td>如果响应还未被提交，设置响应的区域</td>
</tr>
<tr>
<td>void setStatus(int sc)</td>
<td>为该响应设置状态码</td>
</tr>
</tbody></table>
<p>一个例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Refresh</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HttpServlet</span> &#123;<br><br>    <span class="hljs-comment">// 处理 GET 方法请求的方法</span><br>      <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doGet</span><span class="hljs-params">(HttpServletRequest request,</span><br><span class="hljs-params">                        HttpServletResponse response)</span><br>                <span class="hljs-keyword">throws</span> ServletException, IOException<br>      &#123;<br>          <span class="hljs-comment">// 设置刷新自动加载时间为 5 秒</span><br>          response.setIntHeader(<span class="hljs-string">&quot;Refresh&quot;</span>, <span class="hljs-number">5</span>);<br>          <span class="hljs-comment">// 设置响应内容类型</span><br>          response.setContentType(<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span>);<br>         <br>          <span class="hljs-comment">//使用默认时区和语言环境获得一个日历  </span><br>          <span class="hljs-type">Calendar</span> <span class="hljs-variable">cale</span> <span class="hljs-operator">=</span> Calendar.getInstance();  <br>          <span class="hljs-comment">//将Calendar类型转换成Date类型  </span><br>          Date tasktime=cale.getTime();  <br>          <span class="hljs-comment">//设置日期输出的格式  </span><br>          SimpleDateFormat df=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);  <br>          <span class="hljs-comment">//格式化输出  </span><br>          <span class="hljs-type">String</span> <span class="hljs-variable">nowTime</span> <span class="hljs-operator">=</span> df.format(tasktime);<br>          <span class="hljs-type">PrintWriter</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> response.getWriter();<br>          <span class="hljs-type">String</span> <span class="hljs-variable">title</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;自动刷新 Header 设置 - 菜鸟教程实例&quot;</span>;<br>          <span class="hljs-type">String</span> <span class="hljs-variable">docType</span> <span class="hljs-operator">=</span><br>          <span class="hljs-string">&quot;&lt;!DOCTYPE html&gt;\n&quot;</span>;<br>          out.println(docType +<br>            <span class="hljs-string">&quot;&lt;html&gt;\n&quot;</span> +<br>            <span class="hljs-string">&quot;&lt;head&gt;&lt;title&gt;&quot;</span> + title + <span class="hljs-string">&quot;&lt;/title&gt;&lt;/head&gt;\n&quot;</span>+<br>            <span class="hljs-string">&quot;&lt;body bgcolor=\&quot;#f0f0f0\&quot;&gt;\n&quot;</span> +<br>            <span class="hljs-string">&quot;&lt;h1 align=\&quot;center\&quot;&gt;&quot;</span> + title + <span class="hljs-string">&quot;&lt;/h1&gt;\n&quot;</span> +<br>            <span class="hljs-string">&quot;&lt;p&gt;当前时间是：&quot;</span> + nowTime + <span class="hljs-string">&quot;&lt;/p&gt;\n&quot;</span>);<br>      &#125;<br>      <span class="hljs-comment">// 处理 POST 方法请求的方法</span><br>      <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doPost</span><span class="hljs-params">(HttpServletRequest request,</span><br><span class="hljs-params">                         HttpServletResponse response)</span><br>          <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>         doGet(request, response);<br>      &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h2><p>Servlet可以动态的拦截请求和响应，用于变化和使用包含在其中的信息<br>Servlet过滤器是可以用于Servlet编程的Java类，主要目的有以下几个</p>
<ul>
<li>客户端的请求访问资源之前，拦截这些请求</li>
<li>服务器的响应范送给客户端之前，处理这些响应</li>
</ul>
<p>Servlet过滤器的作用：</p>
<ol>
<li>查询请求并作出相应的行为</li>
<li>阻塞请求-响应对，使其不能进一步传递</li>
<li>修改请求头部和数据，用户可以提供自定义请求</li>
<li>修改响应的头部和数据，用户可以通过提供定制的响应版本来实现</li>
<li>与外部资源进行交互</li>
</ol>
<p>根据规范建议的各类型过滤器：</p>
<ol>
<li>身份验证过滤器（Authentication Filters）。</li>
<li>数据压缩过滤器（Data compression Filters）。</li>
<li>加密过滤器（Encryption Filters）。</li>
<li>触发资源访问事件过滤器。</li>
<li>图像转换过滤器（Image Conversion Filters）。</li>
<li>日志记录和审核过滤器（Logging and Auditing Filters）。</li>
<li>MIME-TYPE 链过滤器（MIME-TYPE Chain Filters）。</li>
<li>标记化过滤器（Tokenizing Filters）。</li>
<li>XSL&#x2F;T 过滤器（XSL&#x2F;T Filters），转换 XML 内容</li>
</ol>
<p>过滤器通过web部署文件(web.xml)中的XML标签，然后映射到应用程序的部署描述符中的 Servlet 名称或 URL 模式<br>当web容器启动web应用程序时，他会在部署描述符中声明的每一个过滤器创建一个实例。<br>Filter执行的顺序鱼仔web.xml文件中声明的顺序是一致的。一般我们将Filter的声明放在Servlet之前</p>
<p>Filter的常用方法如下：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>public void doFilter(ServletRequest request,ServletResponse response)</td>
<td>该方法完成实际的过滤操作，当客户端请求方法和过滤器设置的URL匹配时，Servlet容器会优先调用过滤器中的doFilter方法，FilterChain用户访问后续过滤器</td>
</tr>
<tr>
<td>public void init(FilterConfig config)</td>
<td>web应用程序启动时，web服务器将创建Filter对象实例，并调用init方法，读取web.xml中的配置信息，完成对象初始化。filter对象只会创建一次，init方法也只会执行一次，开发人员通过init方法获取参数，可获取当前代表filter配置信息的FilterConfig对象</td>
</tr>
<tr>
<td>public void destory()</td>
<td>Servlet在销毁过滤器实例之前调用的方法，在该方法中释放资源</td>
</tr>
</tbody></table>
<p>Servlet过滤器创建的步骤：</p>
<ol>
<li>实现Filter接口</li>
<li>实现init方法，读取过滤器初始化参数</li>
<li>实现doFilter方法，完成对请求或过滤的响应</li>
<li>调用FilterChain接口对象的doFilter方法，向后续过滤器传递请求或响应</li>
<li>销毁过滤器</li>
</ol>
<p>例子：<br>web.xml文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;4.0&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--请求url日志记录过滤器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>logfilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>com.paulniu.filter.LogFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>logfilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--编码过滤器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>encodingfilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>com.paulniu.filter.EncodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>encoding<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>encodingfilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--测试Servlet--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>DemoServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.paulniu.servlet.DemoServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>DemoServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/demo<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br>    <br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>日志过滤器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LogFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Filter</span> &#123;<br><br>    <span class="hljs-keyword">private</span> FilterConfig config;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(FilterConfig filterConfig)</span> <span class="hljs-keyword">throws</span> ServletException &#123;<br>        System.out.println(<span class="hljs-string">&quot;paulniu:start do the logging filter&quot;</span>);<br>        <span class="hljs-built_in">this</span>.config = config;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doFilter</span><span class="hljs-params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException &#123;<br>        System.out.println(<span class="hljs-string">&quot;paulniu:before the log filter&quot;</span>);<br>        <span class="hljs-comment">// 将请求转换成HttpServletRequest</span><br>        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> (HttpServletRequest) servletRequest;<br>        <span class="hljs-comment">// 将响应转换成HttpServletResponse</span><br>        <span class="hljs-type">HttpServletResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> (HttpServletResponse) servletResponse;<br>        <span class="hljs-comment">// 记录日志</span><br>        System.out.println(<span class="hljs-string">&quot;Log Filter 已经截取到用户请求的地址=&quot;</span> + request.getServletPath());<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// Filter 只链式处理，请求依然转发到目的地址</span><br>            filterChain.doFilter(request, response);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;paulniu:after the log filter&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 销毁日志过滤器</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">this</span>.config = <span class="hljs-literal">null</span>;<br>        System.out.println(<span class="hljs-string">&quot;paulniu:end do the logging filter&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>编码过滤器</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-built_in">public</span> <span class="hljs-keyword">class</span> EncodingFilter implements <span class="hljs-keyword">Filter</span> &#123;<br>    private String <span class="hljs-keyword">encoding</span>;<br>    private HashMap&lt;String, String&gt; params = <span class="hljs-built_in">new</span> HashMap&lt;&gt;();<br><br>    @Override<br>    <span class="hljs-built_in">public</span> <span class="hljs-type">void</span> init(FilterConfig filterConfig) throws ServletException &#123;<br>        // 项目开始时就已经进行读取<br>        <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(&quot;paulniu:before do the encoding filter&quot;);<br>        encoding = filterConfig.getInitParameter(&quot;encoding&quot;);<br>        <span class="hljs-keyword">for</span> (Enumeration&lt;?&gt; e = filterConfig.getInitParameterNames(); e.hasMoreElements(); ) &#123;<br>            String <span class="hljs-type">name</span> = (String) e.nextElement();<br>            String <span class="hljs-keyword">value</span> = filterConfig.getInitParameter(<span class="hljs-type">name</span>);<br>            params.put(<span class="hljs-type">name</span>, <span class="hljs-keyword">value</span>);<br>        &#125;<br>    &#125;<br><br>    @Override<br>    <span class="hljs-built_in">public</span> <span class="hljs-type">void</span> doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;<br>        <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(&quot;paulniu:before encoding &quot; + <span class="hljs-keyword">encoding</span> + &quot; filter!&quot;);<br>        servletRequest.setCharacterEncoding(<span class="hljs-keyword">encoding</span>);<br>        filterChain.doFilter(servletRequest, servletResponse);<br>        <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(&quot;after encoding &quot; + <span class="hljs-keyword">encoding</span> + &quot; filter！&quot;);<br>        <span class="hljs-keyword">System</span>.err.println(&quot;----------------------------------------&quot;);<br>    &#125;<br><br>    @Override<br>    <span class="hljs-built_in">public</span> <span class="hljs-type">void</span> destroy() &#123;<br>        <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(&quot;paulniu:end do the encoding filter&quot;);<br>        params = <span class="hljs-keyword">null</span>;<br>        encoding = <span class="hljs-keyword">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>Servlet测试</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-meta">@WebServlet</span>(name = <span class="hljs-string">&quot;DemoServlet&quot;</span>)<br>public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DemoServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> void doPost(<span class="hljs-type">HttpServletRequest</span> request, <span class="hljs-type">HttpServletResponse</span> response) <span class="hljs-keyword">throws</span> <span class="hljs-type">ServletException</span>, <span class="hljs-type">IOException</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> void doGet(<span class="hljs-type">HttpServletRequest</span> request, <span class="hljs-type">HttpServletResponse</span> response) <span class="hljs-keyword">throws</span> <span class="hljs-type">ServletException</span>, <span class="hljs-type">IOException</span> &#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>测试结果：<br><img src="/assets/JavaEE/javaweb_04.png" srcset="/img/loading.gif" lazyload alt="过滤器demo"></p>
<h3 id="Servlet监听器"><a href="#Servlet监听器" class="headerlink" title="Servlet监听器"></a>Servlet监听器</h3><p>Servlet监听器用于监听一些重要的事情发生，监听器对象可以在事情发生前，发生后做一些必要的处理</p>
<p>ServletContextListener：用于监听web应用的启动和销毁事件，监听器类需要实现ServletContextListener接口</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">public class QuartzListener implements ServletContextListener &#123;  <br>  <br>    private Logger logger = LoggerFactory.getLogger(QuartzListener.class);  <br>  <br>    public void contextInitialized(ServletContextEvent <span class="hljs-keyword">sce) </span>&#123;  <br>  <br>    &#125;  <br>  <br>    <span class="hljs-comment">/** </span><br><span class="hljs-comment">     *在服务器停止运行的时候停止所有的定时任务 </span><br><span class="hljs-comment">     */</span>  <br>    @SuppressWarnings(<span class="hljs-string">&quot;unchecked&quot;</span>)  <br>    public void contextDestroyed(ServletContextEvent arg0) &#123;  <br>        try &#123;  <br>            <span class="hljs-keyword">Scheduler </span><span class="hljs-keyword">scheduler </span>= StdSchedulerFactory.getDefaultScheduler();  <br>            List&lt;<span class="hljs-keyword">JobExecutionContext&gt; </span><span class="hljs-keyword">jobList </span>= <span class="hljs-keyword">scheduler.getCurrentlyExecutingJobs(); </span> <br>            for (<span class="hljs-keyword">JobExecutionContext </span><span class="hljs-keyword">jobContext </span>: <span class="hljs-keyword">jobList) </span>&#123;  <br>                <span class="hljs-keyword">Job </span><span class="hljs-keyword">job </span>= <span class="hljs-keyword">jobContext.getJobInstance(); </span> <br>                if (<span class="hljs-keyword">job </span><span class="hljs-keyword">instanceof </span>InterruptableJob) &#123;  <br>                    ((InterruptableJob) <span class="hljs-keyword">job).interrupt(); </span> <br>                &#125;  <br>            &#125;  <br>            <span class="hljs-keyword">scheduler.shutdown(); </span> <br>        &#125; catch (<span class="hljs-keyword">SchedulerException </span>e) &#123;  <br>            logger.error(<span class="hljs-string">&quot;shut down scheduler happened error&quot;</span>, e);  <br>        &#125;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure>

<p>ServletContextAttributeListener:用于监听Web应用属性改变的事件，包括增加属性，删除属性，修改属性，监听器类需要实现ServletContextAttributeListener接口</p>
<p>HttpSessionListener：用于监听Session对象的创建和销毁，监听器类需要实现HttpSessionListener接口或者HttpSessionActivationListener接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SessionListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HttpSessionListener</span> &#123;  <br>  <br>    <span class="hljs-meta">@Override</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sessionCreated</span><span class="hljs-params">(HttpSessionEvent arg0)</span> &#123;  <br>  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@Override</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sessionDestroyed</span><span class="hljs-params">(HttpSessionEvent event)</span> &#123;  <br>        <span class="hljs-type">HttpSession</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> event.getSession();  <br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> (BrsSession) session.getAttribute(<span class="hljs-string">&quot;currUser&quot;</span>);  <br>        <span class="hljs-keyword">if</span> (user != <span class="hljs-literal">null</span>) &#123;  <br>            <span class="hljs-comment">//TODO something  </span><br>        &#125;  <br>    &#125;  <br>  <br>&#125;  <br></code></pre></td></tr></table></figure>

<p>HttpSessionActivationListener:用于监听Session对象的钝化&#x2F;活化事件，监听器类需要实现javax.servlet.http.HttpSessionListener接口或者javax.servlet.http.HttpSessionActivationListener接口，或者两个都实现。</p>
<p>HttpSessionAttributeListener：用于监听Session对象属性的改变事件，监听类需要实现</p>
<p>部署：监听器的部署在web.xml文件中配置，在配置文件中，它的位置应该在过滤器的后面Servlet的前面</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- Quartz监听器 --&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">listener</span>&gt;</span>  <br>    <span class="hljs-tag">&lt;<span class="hljs-name">listener-class</span>&gt;</span>  <br>        com.flyer.lisenter.QuartzListener  <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">listener-class</span>&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">listener</span>&gt;</span> <br></code></pre></td></tr></table></figure>

<h2 id="Servlet异常处理"><a href="#Servlet异常处理" class="headerlink" title="Servlet异常处理"></a>Servlet异常处理</h2><p>当一个Servlet抛出一个异常，Web容器通过exception-type元素的web.xml中搜索和抛出异常类型相匹配的设置<br>必须在 web.xml 中使用 error-page 元素来指定对特定异常 或 HTTP 状态码 作出相应的 Servlet 调用</p>
<p>web.xml配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;4.0&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--请求url日志记录过滤器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>logfilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>com.paulniu.filter.LogFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>logfilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--编码过滤器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>encodingfilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>com.paulniu.filter.EncodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>encoding<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>encodingfilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--error-code相关页面--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">error-page</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">error-code</span>&gt;</span>404<span class="hljs-tag">&lt;/<span class="hljs-name">error-code</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">location</span>&gt;</span>/ErrorHandler<span class="hljs-tag">&lt;/<span class="hljs-name">location</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">error-page</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">error-page</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">error-code</span>&gt;</span>403<span class="hljs-tag">&lt;/<span class="hljs-name">error-code</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">location</span>&gt;</span>/ErrorHandler<span class="hljs-tag">&lt;/<span class="hljs-name">location</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">error-page</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--exception-type相关页面--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">error-page</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">exception-type</span>&gt;</span>javax.servlet.ServletException<span class="hljs-tag">&lt;/<span class="hljs-name">exception-type</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">location</span>&gt;</span>/ErrorHandler<span class="hljs-tag">&lt;/<span class="hljs-name">location</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">error-page</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">error-page</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">exception-type</span>&gt;</span>java.io.IOException<span class="hljs-tag">&lt;/<span class="hljs-name">exception-type</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">location</span>&gt;</span>/ErrorHandler<span class="hljs-tag">&lt;/<span class="hljs-name">location</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">error-page</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--测试Servlet--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>DemoServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.paulniu.servlet.DemoServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>DemoServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/demo<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--错误处理Servlet--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>ErrorHandler<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.paulniu.servlet.ErrorHandler<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>ErrorHandler<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/ErrorHandler<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>异常处理页面：</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs sas">public class ErrorHandler extends HttpServlet &#123;<br><br>    @Override<br>    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;<br>        Throwable throwable = (Throwable)<br>                request.getAttribute(<span class="hljs-string">&quot;javax.servlet.error.exception&quot;</span>);<br>        Integer statusCode = (Integer)<br>                request.getAttribute(<span class="hljs-string">&quot;javax.servlet.error.status_code&quot;</span>);<br>        String servletName = (String)<br>                request.getAttribute(<span class="hljs-string">&quot;javax.servlet.error.servlet_name&quot;</span>);<br>        <span class="hljs-keyword">if</span> (servletName == <span class="hljs-keyword">null</span>) &#123;<br>            servletName = <span class="hljs-string">&quot;Unknown&quot;</span>;<br>        &#125;<br>        String requestUri = (String)<br>                request.getAttribute(<span class="hljs-string">&quot;javax.servlet.error.request_uri&quot;</span>);<br>        <span class="hljs-keyword">if</span> (requestUri == <span class="hljs-keyword">null</span>) &#123;<br>            requestUri = <span class="hljs-string">&quot;Unknown&quot;</span>;<br>        &#125;<br>        // 设置响应内容类型<br>        response.setContentType(<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span>);<br><br>        PrintWriter <span class="hljs-keyword">out</span> = response.getWriter();<br>        String <span class="hljs-keyword">title</span> = <span class="hljs-string">&quot;JavaWeb Error/Exception 信息&quot;</span>;<br><br>        String docType = <span class="hljs-string">&quot;&lt;!DOCTYPE html&gt;\n&quot;</span>;<br>        <span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(docType +<br>                <span class="hljs-string">&quot;&lt;html&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;head&gt;&lt;title&gt;&quot;</span> + <span class="hljs-keyword">title</span> + <span class="hljs-string">&quot;&lt;/title&gt;&lt;/head&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;body bgcolor=\&quot;#f0f0f0\&quot;&gt;\n&quot;</span>);<br>        <span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;&lt;h1&gt;JavaWeb异常信息实例演示&lt;/h1&gt;&quot;</span>);<br>        <span class="hljs-keyword">if</span> (throwable == <span class="hljs-keyword">null</span> <span class="hljs-variable">&amp;&amp;</span> statusCode == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;&lt;h2&gt;错误信息丢失&lt;/h2&gt;&quot;</span>);<br>            <span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;请返回 &lt;a href=\&quot;&quot;</span> +<br>                    response.encodeURL(<span class="hljs-string">&quot;http://localhost:8080/&quot;</span>) +<br>                    <span class="hljs-string">&quot;\&quot;&gt;主页&lt;/a&gt;。&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (statusCode != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;错误代码 : &quot;</span> + statusCode);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;&lt;h2&gt;错误信息&lt;/h2&gt;&quot;</span>);<br>            <span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;Servlet Name : &quot;</span> + servletName +<br>                    <span class="hljs-string">&quot;&lt;/br&gt;&lt;/br&gt;&quot;</span>);<br>            <span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;异常类型 : &quot;</span> +<br>                    throwable.getClass().getName() +<br>                    <span class="hljs-string">&quot;&lt;/br&gt;&lt;/br&gt;&quot;</span>);<br>            <span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;请求 URI: &quot;</span> + requestUri +<br>                    <span class="hljs-string">&quot;&lt;br&gt;&lt;br&gt;&quot;</span>);<br>            <span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;异常信息: &quot;</span> +<br>                    throwable.getMessage());<br>        &#125;<br>        <span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;&lt;/body&gt;&quot;</span>);<br>        <span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;&lt;/html&gt;&quot;</span>);<br>    &#125;<br><br>    @Override<br>    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;<br>        doGet(req, resp);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>测试结果：<br>在浏览器中输入错误的地址<br><img src="/assets/JavaEE/javaweb_05.png" srcset="/img/loading.gif" lazyload alt="Servlet异常"></p>
<h2 id="Servlet-Cookie处理"><a href="#Servlet-Cookie处理" class="headerlink" title="Servlet Cookie处理"></a>Servlet Cookie处理</h2><p>Cookie是存储在客户端上的文本文件，由服务器生成，发送给User-Agent，浏览器会将Cookie的key&#x2F;value保存到某个目录下的文本文件内，下次请求同一网站时，发送该Cookie给服务器。Cookie的key和value都是由服务器自己规定的，对于JSP而言可以直接写入JSESSIONID用于标记一个回话的Session，这样服务器可以知道该用户是否为合法用户或是否需要重新登录，服务器可以设置和读取Cookie中的信息，借此维护用户在服务器中的状态</p>
<p>Cookie的原理：</p>
<ol>
<li>首先浏览器想服务器发送请求</li>
<li>服务器会根据需求生成一个Cookie对象，并且把数据保存在该对象中</li>
<li>然后把Cookie对象放在响应头中，并发送会给浏览器</li>
<li>浏览器收到服务器响应之后，提出该Cookie保存在浏览器端</li>
<li>当浏览器再次访问那个服务器，会把这个Cookie放在请求头并发送给服务器</li>
<li>服务器从请求头中提取Cookie，判别数据执行相应的操作</li>
</ol>
<h3 id="Cookie剖析"><a href="#Cookie剖析" class="headerlink" title="Cookie剖析"></a>Cookie剖析</h3><p>Cookie通常设置在HTTP头信息中(虽然JavaScript也可以直接在浏览器设置一个Cookie)。设置Cookie的Servlet会发送如下的头信息<br><img src="/assets/JavaEE/javaweb_06.png" srcset="/img/loading.gif" lazyload alt="图片是我拷贝的"></p>
<p>如图所示，Set-Cookie头包含了一个名称值对，一个GMT日期，一个路径和一个域。名称和值会被URL编码。expires字段是一个指令，告诉浏览器在给定的时间和日期之后忘记Cookie<br>如果浏览器被配置为存储Cookie，他将会保留此信息直到到期日期。如果用户的浏览器指向任何匹配该Cookie的路径和域的页面，他会重新发送Cookie到服务器，浏览器的头信息可能如下：<br><img src="/assets/JavaEE/javaweb_07.png" srcset="/img/loading.gif" lazyload alt="图片是我拷贝的"></p>
<p>Cookie方法：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>public void setDomain(String pattern)</td>
<td>该方法设置cookie使用的域</td>
</tr>
<tr>
<td>public String getDomain()</td>
<td>该方法获取cookie适用的域</td>
</tr>
<tr>
<td>public void setMaxAge(int expiry)</td>
<td>设置cookie过期的时间，以秒为单位，如果不设置，则cookie会在当前Session会话中持续有效</td>
</tr>
<tr>
<td>public int getMaxAge()</td>
<td>该方法返回cookie的最大生存周期，以秒为单位，默认情况下为-1，表示cookie会持续下去，知道浏览器关闭</td>
</tr>
<tr>
<td>public String getName()</td>
<td>该方法返回cookie名称，名称在创建后不能改变</td>
</tr>
<tr>
<td>public void setValue(String newValue)</td>
<td>该方法设置与cookie关联的值</td>
</tr>
<tr>
<td>public String getValue()</td>
<td>方法获取与cookie相关联的值</td>
</tr>
<tr>
<td>public void setPath(String uri)</td>
<td>该方法设置cookie使用的路径，如果不指定路径，与当前页面相同目录下的(包括子目录)所有URL都会返回cookie</td>
</tr>
<tr>
<td>public String getPath()</td>
<td>该方法获取Cookie使用的路径</td>
</tr>
<tr>
<td>public void setSecure(boolean flag)</td>
<td>该方法设置布尔值，表示cookie是否应该只在加密的(即SSL)连接上发送</td>
</tr>
<tr>
<td>public void setComment(String purpose)</td>
<td>设置cookie的注解，该注解在浏览器向用户呈现cookie时非常有用</td>
</tr>
<tr>
<td>public String getComment()</td>
<td>获取cookie的注释，如果cookie没有注释则返回null</td>
</tr>
</tbody></table>
<h3 id="Cookie的使用"><a href="#Cookie的使用" class="headerlink" title="Cookie的使用"></a>Cookie的使用</h3><p>创建一个Cookie</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">public <span class="hljs-keyword">class</span> CookieServlet extends HttpServlet &#123;<br><br>    @Override<br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Post(HttpServletRequest <span class="hljs-params">req</span>, HttpServletResponse <span class="hljs-params">resp</span>)</span> throws ServletException, IOException &#123;<br>        <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(<span class="hljs-params">req</span>, <span class="hljs-params">resp</span>)</span>;<br>    &#125;<br><br>    @Override<br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(HttpServletRequest <span class="hljs-params">req</span>, HttpServletResponse <span class="hljs-params">resp</span>)</span> throws ServletException, IOException &#123;<br>        Cookie cookie = <span class="hljs-keyword">new</span> <span class="hljs-constructor">Cookie(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;value&quot;</span>)</span>;<br>        resp.add<span class="hljs-constructor">Cookie(<span class="hljs-params">cookie</span>)</span>;<br><br>        <span class="hljs-comment">// 得到浏览器传递的cookie数据</span><br>        Cookie<span class="hljs-literal">[]</span> cookies = req.get<span class="hljs-constructor">Cookies()</span>;<br>        <span class="hljs-keyword">if</span> (cookies != null) &#123;<br>            <span class="hljs-keyword">for</span> (Cookie c : cookies) &#123;<br>                String name = c.get<span class="hljs-constructor">Name()</span>;<br>                String value = c.get<span class="hljs-constructor">Value()</span>;<br>                <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>out.println(name + <span class="hljs-string">&quot;=&quot;</span> + value);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>out.println(<span class="hljs-string">&quot;没有Cookie信息！&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>运行结果：<br><img src="/assets/JavaEE/javaweb_08.png" srcset="/img/loading.gif" lazyload alt="Cookie使用"></p>
<p>这里我们可以模拟一个登陆的例子，因为里面需要使用到Session的内容，所以我们等Session的内容完成之后一块写一个例子</p>
<h2 id="Servlet中的Session"><a href="#Servlet中的Session" class="headerlink" title="Servlet中的Session"></a>Servlet中的Session</h2><p>HTTP是一种无状态的协议，这意味着每次客户端检索网页时，客户端打开一个单独的链接到服务器，服务器会自动不保留之前客户端的任何请求记录。但是仍然以下面三种方式维持客户端和服务器之间的session回话</p>
<ul>
<li>Cookie:一个web服务器可以分配一个唯一的SessionID作为每一个客户端的Cookie，对于客户端的后续请求，可以使用接收到的Cookie来识别。(但是很多浏览器可能不支持Cookie，所以这个并不是最优的解决方案)</li>
<li>隐藏的表单字段：一个Web服务器可以发送一个隐藏的HTML表单字段，以及唯一的一个Session回话ID，如<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;input <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;hide&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-string">&quot;sessionid&quot;</span> <span class="hljs-attribute">value</span>=<span class="hljs-string">&quot;123456&quot;</span>&gt;<br></code></pre></td></tr></table></figure>
,这意味着当表单被提交的时候，指定的名称和值会自动包含在GET和POST请求中。每当浏览器发送请求时，session_id值可以可以用于保持不同浏览器的追踪。这个方式相对而言比较合理，但是对于一些超链接标签，我们没有发送网络请求，所以不会提交表单，所以也不是非常好的解决办法</li>
<li>URL重定向：我们可以为每一个URL的末尾追加一些额外的数据来标识session会话。服务器会将传递过来session标识和已存储的相关session会话数据相关联，如：<a target="_blank" rel="noopener" href="http://www.paulniu.com/login.jsp;sessionid=123456">http://www.paulniu.com/login.jsp;sessionid=123456</a> URL重定向是一种更好的方式来维持Session会话，他在浏览器不支持Cookie时可以很好的完成维持Session会话的工作，缺点是会动态的生成每个URL来为页面分配一个sessionid，即使是很简单的静态页面也是如此。</li>
</ul>
<p>除了上面的三种方式，Servlet还提供了HttpSession接口，该接口提供了一种跨多个页面请求或访问网站时识别用户以及存储用户相关信息的方法。<br>Servlet 容器使用这个接口来创建一个 HTTP 客户端和 HTTP 服务器之间的 session 会话。会话持续一个指定的时间段，跨多个连接或页面请求。<br>我们会通过调用 HttpServletRequest 的公共方法 getSession() 来获取 HttpSession 对象</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">HttpSession session <span class="hljs-operator">=</span> request.getSession()<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>

<p>Session常用方法：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>public Object getAttribute(String name)</td>
<td>该方法返回在该Session会话中具有指定名称的对象，如果没有指定名称的对象，返回null</td>
</tr>
<tr>
<td>public Enumeration getAttributeNames()</td>
<td>该方法返回String类型对象的枚举，String对象包含所有绑定到该Session会话的对象的名称</td>
</tr>
<tr>
<td>public long getCreationTime()</td>
<td>该方法返回Session会话被创建的时间,以毫秒为单位</td>
</tr>
<tr>
<td>public String getId()</td>
<td>该方法返回一个包含Session会话唯一标识符的字符串</td>
</tr>
<tr>
<td>public long getLastAccessedTime()</td>
<td>该方法返回客户端最后一次发送与Session会话相关的请求的时间，以毫秒为单位</td>
</tr>
<tr>
<td>public int getMaxInactiveInterval()</td>
<td>该方法返回Servlet容器在客户端访问时保持session会话打开的最大时间间隔，以秒为单位</td>
</tr>
<tr>
<td>public void invalindate()</td>
<td>指示该Session会话无效，并解除绑定到它上面的任何对象</td>
</tr>
<tr>
<td>public boolean isNew()</td>
<td>如果客户端还不知道该Session会话，或者客户端选择不参与该Session会话，返回true</td>
</tr>
<tr>
<td>public void removeAttribute(String name)</td>
<td>从Session会话中移除指定名称对象</td>
</tr>
<tr>
<td>public void setAttribute(String name,Object value)</td>
<td>该方法使用指定的名称绑定一个对象到该Session会话</td>
</tr>
<tr>
<td>public void setMaxInactiveInterval(int interval)</td>
<td>该方法在Servlet中指示该Session会话无效之前，指定客户端请求之前的时间，以秒为单位</td>
</tr>
</tbody></table>
<p>Session追踪实例：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">public <span class="hljs-keyword">class</span> SessionTrackServlet extends HttpServlet &#123;<br><br>    <span class="hljs-keyword">private</span> static final long serialVersionUID = <span class="hljs-number">1L</span>;<br><br>    @Override<br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Post(HttpServletRequest <span class="hljs-params">req</span>, HttpServletResponse <span class="hljs-params">resp</span>)</span> throws ServletException, IOException &#123;<br>        <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(<span class="hljs-params">req</span>, <span class="hljs-params">resp</span>)</span>;<br>    &#125;<br><br>    @Override<br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(HttpServletRequest <span class="hljs-params">req</span>, HttpServletResponse <span class="hljs-params">response</span>)</span> throws ServletException, IOException &#123;<br>        <span class="hljs-comment">// 如果不存在Session会话，则创建一个Session会话</span><br>        HttpSession session = req.get<span class="hljs-constructor">Session(<span class="hljs-params">true</span>)</span>;<br>        <span class="hljs-comment">// 获取Session创建的时间</span><br>        Date createTime = <span class="hljs-keyword">new</span> <span class="hljs-constructor">Date(<span class="hljs-params">session</span>.<span class="hljs-params">getCreationTime</span>()</span>);<br>        <span class="hljs-comment">// 获取该网页最后一次访问的时间</span><br>        Date lastAccessTime = <span class="hljs-keyword">new</span> <span class="hljs-constructor">Date(<span class="hljs-params">session</span>.<span class="hljs-params">getLastAccessedTime</span>()</span>);<br><br>        <span class="hljs-comment">// 设置日期输出格式</span><br>        SimpleDateFormat df = <span class="hljs-keyword">new</span> <span class="hljs-constructor">SimpleDateFormat(<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>)</span>;<br><br>        String title = <span class="hljs-string">&quot;Servlet session 实例&quot;</span>;<br>        Integer visitCount = <span class="hljs-keyword">new</span> <span class="hljs-constructor">Integer(0)</span>;<br>        String visitCountKey = <span class="hljs-keyword">new</span> <span class="hljs-constructor">String(<span class="hljs-string">&quot;visitCount&quot;</span>)</span>;<br>        String userIDKey = <span class="hljs-keyword">new</span> <span class="hljs-constructor">String(<span class="hljs-string">&quot;userID&quot;</span>)</span>;<br>        String userID = <span class="hljs-keyword">new</span> <span class="hljs-constructor">String(<span class="hljs-string">&quot;paulniu&quot;</span>)</span>;<br>        <span class="hljs-keyword">if</span> (session.get<span class="hljs-constructor">Attribute(<span class="hljs-params">visitCountKey</span>)</span><span class="hljs-operator"> == </span>null) &#123;<br>            session.set<span class="hljs-constructor">Attribute(<span class="hljs-params">visitCountKey</span>, <span class="hljs-params">new</span> Integer(0)</span>);<br>        &#125;<br><br>        <span class="hljs-comment">// 检查网页上是否有新的访问者</span><br>        <span class="hljs-keyword">if</span> (session.is<span class="hljs-constructor">New()</span>) &#123;<br>            title = <span class="hljs-string">&quot;Servlet Session 实例&quot;</span>;<br>            session.set<span class="hljs-constructor">Attribute(<span class="hljs-params">userIDKey</span>, <span class="hljs-params">userID</span>)</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            visitCount = (Integer) session.get<span class="hljs-constructor">Attribute(<span class="hljs-params">visitCountKey</span>)</span>;<br>            visitCount = visitCount + <span class="hljs-number">1</span>;<br>            userID = (String) session.get<span class="hljs-constructor">Attribute(<span class="hljs-params">userIDKey</span>)</span>;<br>        &#125;<br>        session.set<span class="hljs-constructor">Attribute(<span class="hljs-params">visitCountKey</span>, <span class="hljs-params">visitCount</span>)</span>;<br><br>        <span class="hljs-comment">// 设置响应内容类型</span><br>        response.set<span class="hljs-constructor">ContentType(<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span>)</span>;<br>        PrintWriter out = response.get<span class="hljs-constructor">Writer()</span>;<br><br>        String docType = <span class="hljs-string">&quot;&lt;!DOCTYPE html&gt;\n&quot;</span>;<br>        out.println(docType +<br>                <span class="hljs-string">&quot;&lt;html&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;head&gt;&lt;title&gt;&quot;</span> + title + <span class="hljs-string">&quot;&lt;/title&gt;&lt;/head&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;body bgcolor=\&quot;#f0f0f0\&quot;&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;h1 align=\&quot;center\&quot;&gt;&quot;</span> + title + <span class="hljs-string">&quot;&lt;/h1&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;h2 align=\&quot;center\&quot;&gt;Session 信息&lt;/h2&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;table border=\&quot;1\&quot; align=\&quot;center\&quot;&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;tr bgcolor=\&quot;#949494\&quot;&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;  &lt;th&gt;Session 信息&lt;/th&gt;&lt;th&gt;值&lt;/th&gt;&lt;/tr&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;tr&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;  &lt;td&gt;id&lt;/td&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;  &lt;td&gt;&quot;</span> + session.get<span class="hljs-constructor">Id()</span> + <span class="hljs-string">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;tr&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;  &lt;td&gt;创建时间&lt;/td&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;  &lt;td&gt;&quot;</span> + df.format(createTime) +<br>                <span class="hljs-string">&quot;  &lt;/td&gt;&lt;/tr&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;tr&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;  &lt;td&gt;最后访问时间&lt;/td&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;  &lt;td&gt;&quot;</span> + df.format(lastAccessTime) +<br>                <span class="hljs-string">&quot;  &lt;/td&gt;&lt;/tr&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;tr&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;  &lt;td&gt;用户 ID&lt;/td&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;  &lt;td&gt;&quot;</span> + userID +<br>                <span class="hljs-string">&quot;  &lt;/td&gt;&lt;/tr&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;tr&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;  &lt;td&gt;访问统计：&lt;/td&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;  &lt;td&gt;&quot;</span> + visitCount + <span class="hljs-string">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;/table&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>处理结果：<br><img src="/assets/JavaEE/javaweb_09.png" srcset="/img/loading.gif" lazyload alt="session追踪"></p>
<h2 id="登录demo"><a href="#登录demo" class="headerlink" title="登录demo"></a>登录demo</h2><p>使用Cookie登录</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">public <span class="hljs-keyword">class</span> LoginCookieServlet extends HttpServlet &#123;<br><br>    <span class="hljs-keyword">private</span> static final long serialVersionUID = <span class="hljs-number">1L</span>;<br><br>    public <span class="hljs-constructor">LoginCookieServlet()</span>&#123;<br><br>    &#125;<br><br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Post(HttpServletRequest <span class="hljs-params">request</span>, HttpServletResponse <span class="hljs-params">response</span>)</span> throws ServletException, IOException &#123;<br>        <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(<span class="hljs-params">request</span>,<span class="hljs-params">response</span>)</span>;<br>        <span class="hljs-comment">// 获取表达中的username和password</span><br>        String username = request.get<span class="hljs-constructor">Parameter(<span class="hljs-string">&quot;username&quot;</span>)</span>;<br>        String password = request.get<span class="hljs-constructor">Parameter(<span class="hljs-string">&quot;password&quot;</span>)</span>;<br><br>        <span class="hljs-comment">// 定义一个名为username</span><br>        Cookie cookie = <span class="hljs-keyword">new</span> <span class="hljs-constructor">Cookie(<span class="hljs-params">username</span>,<span class="hljs-params">password</span>)</span>;<br>        cookie.set<span class="hljs-constructor">Path(<span class="hljs-string">&quot;&quot;</span>)</span>;<br>        cookie.set<span class="hljs-constructor">Comment(<span class="hljs-string">&quot;这是一个cookie&quot;</span>)</span>;<br>        response.add<span class="hljs-constructor">Cookie(<span class="hljs-params">cookie</span>)</span>;<br>        request.get<span class="hljs-constructor">RequestDispatcher(<span class="hljs-string">&quot;loginSuccess.jsp&quot;</span>)</span>.forward(request,response);<br>    &#125;<br><br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(HttpServletRequest <span class="hljs-params">request</span>, HttpServletResponse <span class="hljs-params">response</span>)</span> throws ServletException, IOException &#123;<br>        response.get<span class="hljs-constructor">Writer()</span>.append(<span class="hljs-string">&quot;serverd ad:&quot;</span>).append(request.get<span class="hljs-constructor">ServletPath()</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>jsp页面</p>
<figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs erb"><span class="language-xml">&lt;%</span><span class="language-ruby">@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> </span><span class="language-xml">%&gt;</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>登录demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;login&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> /&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;登录&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<p><img src="/assets/JavaEE/javaweb_10.png" srcset="/img/loading.gif" lazyload alt="登陆成功之后将cookie对象发送到浏览器中"></p>
<p>使用Session登录</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">public <span class="hljs-keyword">class</span> LoginSessionServlet extends HttpServlet &#123;<br><br>    <span class="hljs-keyword">private</span> static final long serialVersionUID = <span class="hljs-number">1L</span>;<br><br>    @Override<br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(HttpServletRequest <span class="hljs-params">req</span>, HttpServletResponse <span class="hljs-params">resp</span>)</span> throws ServletException, IOException &#123;<br>        resp.get<span class="hljs-constructor">Writer()</span>.append(<span class="hljs-string">&quot;served at: &quot;</span>).append(req.get<span class="hljs-constructor">ServletPath()</span>);<br>    &#125;<br><br>    @Override<br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Post(HttpServletRequest <span class="hljs-params">req</span>, HttpServletResponse <span class="hljs-params">resp</span>)</span> throws ServletException, IOException &#123;<br>        String username = req.get<span class="hljs-constructor">Parameter(<span class="hljs-string">&quot;username&quot;</span>)</span>;<br>        String password = req.get<span class="hljs-constructor">Parameter(<span class="hljs-string">&quot;password&quot;</span>)</span>;<br>        User user = <span class="hljs-keyword">new</span> <span class="hljs-constructor">User(<span class="hljs-params">username</span>,<span class="hljs-params">password</span>)</span>;<br><br>        DateFormat dateFormat = <span class="hljs-keyword">new</span> <span class="hljs-constructor">SimpleDateFormat(<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>)</span>;<br>        String dateTime = dateFormat.format(<span class="hljs-keyword">new</span> <span class="hljs-constructor">Date()</span>);<br>        HttpSession session = req.get<span class="hljs-constructor">Session()</span>;<br>        session.set<span class="hljs-constructor">Attribute(<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-params">user</span>)</span>;<br>        session.set<span class="hljs-constructor">Attribute(<span class="hljs-string">&quot;loginTime&quot;</span>,<span class="hljs-params">dateTime</span>)</span>;<br>        session.set<span class="hljs-constructor">Attribute(<span class="hljs-string">&quot;sessionId&quot;</span>,<span class="hljs-params">session</span>.<span class="hljs-params">getId</span>()</span>);<br>        <span class="hljs-comment">// 请求转发</span><br>        req.get<span class="hljs-constructor">RequestDispatcher(<span class="hljs-string">&quot;loginSuccess.jsp&quot;</span>)</span>.forward(req,resp);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>jsp页面：</p>
<figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs erb"><span class="language-xml">// login.jsp</span><br><span class="language-xml">&lt;%</span><span class="language-ruby">@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> </span><span class="language-xml">%&gt;</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>登录demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;loginsession&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>/&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;登录&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml">// loginSuccess.jsp</span><br><span class="language-xml">&lt;%</span><span class="language-ruby">@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> </span><span class="language-xml">%&gt;</span><br><span class="language-xml">&lt;%</span><span class="language-ruby"><span class="hljs-variable">@page</span> import=<span class="hljs-string">&quot;java.text.DateFormat&quot;</span> </span><span class="language-xml">%&gt;</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">jsp:directive.page</span> <span class="hljs-attr">import</span>=<span class="hljs-string">&quot;com.paulniu.bean.User&quot;</span>/&gt;</span></span><br><span class="language-xml">&lt;%</span><span class="language-ruby"> <span class="hljs-title class_">User</span> user = (<span class="hljs-title class_">User</span>) session.getAttribute(<span class="hljs-string">&quot;user&quot;</span>);</span><br><span class="language-ruby">    <span class="hljs-title class_">String</span> dateTime = (<span class="hljs-title class_">String</span>) session.getAttribute(<span class="hljs-string">&quot;loginTime&quot;</span>);</span><br><span class="language-ruby">    <span class="hljs-title class_">String</span> sessionId = (<span class="hljs-title class_">String</span>) session.getAttribute(<span class="hljs-string">&quot;sessionId&quot;</span>);</span><br><span class="language-ruby"></span><span class="language-xml">%&gt;</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>登录结果页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">Hello,this is an index page.<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">    用户名：&lt;%=</span><span class="language-ruby">user.getUserName()</span><span class="language-xml">%&gt;<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">    密码：&lt;%=</span><span class="language-ruby">user.getPassword()</span><span class="language-xml">%&gt;<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">    登陆时间：&lt;%=</span><span class="language-ruby">dateTime </span><span class="language-xml">%&gt;<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">    SessionId：&lt;%=</span><span class="language-ruby">sessionId </span><span class="language-xml">%&gt;<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure>
<p>User对象</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> userName;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> password;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">User</span>(<span class="hljs-title class_">String</span> userName, <span class="hljs-title class_">String</span> password) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">userName</span> = userName;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">password</span> = password;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">User</span>() &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getUserName</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> userName;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setUserName</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> userName</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">userName</span> = userName;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getPassword</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> password;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setPassword</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> password</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">password</span> = password;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">toString</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;User&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;userName=&#x27;&quot;</span> + userName + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, password=&#x27;&quot;</span> + password + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在没有提交表单之前<br><img src="/assets/JavaEE/javaweb_11.png" srcset="/img/loading.gif" lazyload alt="原始SessionID"></p>
<p>表单提交之后<br><img src="/assets/JavaEE/javaweb_12.png" srcset="/img/loading.gif" lazyload alt="从服务器端返回的SessionID"></p>
<h2 id="Servlet-数据库"><a href="#Servlet-数据库" class="headerlink" title="Servlet 数据库"></a>Servlet 数据库</h2><p>准备测试数据</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `websites` (<br>  `id` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT,<br>  `<span class="hljs-type">name</span>` <span class="hljs-type">char</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">COMMENT</span> <span class="hljs-string">&#x27;站点名称&#x27;</span>,<br>  `url` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>  `alexa` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">COMMENT</span> <span class="hljs-string">&#x27;Alexa 排名&#x27;</span>,<br>  `country` <span class="hljs-type">char</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">COMMENT</span> <span class="hljs-string">&#x27;国家&#x27;</span>,<br>  <span class="hljs-keyword">PRIMARY KEY</span> (`id`)<br>) ENGINE=InnoDB AUTO_INCREMENT=<span class="hljs-number">10</span> <span class="hljs-keyword">DEFAULT</span> CHARSET=utf8;<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `websites` <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;Google&#x27;</span>, <span class="hljs-string">&#x27;https://www.google.cm/&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;USA&#x27;</span>), (<span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&#x27;淘宝&#x27;</span>, <span class="hljs-string">&#x27;https://www.taobao.com/&#x27;</span>, <span class="hljs-string">&#x27;13&#x27;</span>, <span class="hljs-string">&#x27;CN&#x27;</span>), (<span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&#x27;菜鸟教程&#x27;</span>, <span class="hljs-string">&#x27;http://www.runoob.com&#x27;</span>, <span class="hljs-string">&#x27;5892&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>), (<span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;微博&#x27;</span>, <span class="hljs-string">&#x27;http://weibo.com/&#x27;</span>, <span class="hljs-string">&#x27;20&#x27;</span>, <span class="hljs-string">&#x27;CN&#x27;</span>), (<span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-string">&#x27;Facebook&#x27;</span>, <span class="hljs-string">&#x27;https://www.facebook.com/&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&#x27;USA&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>访问数据库</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataBaseServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HttpServlet</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1l</span>;<br><br>    <span class="hljs-comment">//JDBC驱动名以及数据库URL</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">JDBC_DRIVER</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DB_URL</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/javawebdb&quot;</span>;<br><br>    <span class="hljs-comment">// 数据库的用户名和密码</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">USER</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">PASS</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DataBaseServlet</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>        <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-comment">// 设置响应内容类型</span><br>        resp.setContentType(<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span>);<br>        <span class="hljs-type">PrintWriter</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> resp.getWriter();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">title</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Servlet Mysql 测试&quot;</span>;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">docType</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&lt;!DOCTYPE html&gt;\n&quot;</span>;<br>        out.println(docType +<br>                <span class="hljs-string">&quot;&lt;html&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;head&gt;&lt;title&gt;&quot;</span> + title + <span class="hljs-string">&quot;&lt;/title&gt;&lt;/head&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;body bgcolor=\&quot;#f0f0f0\&quot;&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;h1 align=\&quot;center\&quot;&gt;&quot;</span> + title + <span class="hljs-string">&quot;&lt;/h1&gt;\n&quot;</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 注册 JDBC 驱动器</span><br>            Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br><br>            <span class="hljs-comment">// 打开一个连接</span><br>            conn = DriverManager.getConnection(DB_URL, USER, PASS);<br><br>            <span class="hljs-comment">// 执行 SQL 查询</span><br>            stmt = conn.createStatement();<br>            String sql;<br>            sql = <span class="hljs-string">&quot;SELECT id, name, url FROM websites&quot;</span>;<br>            <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> stmt.executeQuery(sql);<br><br>            <span class="hljs-comment">// 展开结果集数据库</span><br>            <span class="hljs-keyword">while</span> (rs.next()) &#123;<br>                <span class="hljs-comment">// 通过字段检索</span><br>                <span class="hljs-type">int</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> rs.getInt(<span class="hljs-string">&quot;id&quot;</span>);<br>                <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> rs.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>                <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> rs.getString(<span class="hljs-string">&quot;url&quot;</span>);<br><br>                <span class="hljs-comment">// 输出数据</span><br>                out.println(<span class="hljs-string">&quot;ID: &quot;</span> + id);<br>                out.println(<span class="hljs-string">&quot;, 站点名称: &quot;</span> + name);<br>                out.println(<span class="hljs-string">&quot;, 站点 URL: &quot;</span> + url);<br>                out.println(<span class="hljs-string">&quot;&lt;br /&gt;&quot;</span>);<br>            &#125;<br>            out.println(<span class="hljs-string">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>);<br><br>            <span class="hljs-comment">// 完成后关闭</span><br>            rs.close();<br>            stmt.close();<br>            conn.close();<br>        &#125; <span class="hljs-keyword">catch</span> (SQLException se) &#123;<br>            <span class="hljs-comment">// 处理 JDBC 错误</span><br>            se.printStackTrace();<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-comment">// 处理 Class.forName 错误</span><br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">// 最后是用于关闭资源的块</span><br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">if</span> (stmt != <span class="hljs-literal">null</span>)<br>                    stmt.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException se2) &#123;<br>            &#125;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">if</span> (conn != <span class="hljs-literal">null</span>)<br>                    conn.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException se) &#123;<br>                se.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>        doGet(req, resp);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>运行结果<br><img src="/assets/JavaEE/javaweb_13.png" srcset="/img/loading.gif" lazyload alt="运行结果"></p>
<p>如果向数据库中插入数据</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">//编写预处理 SQL 语句</span><br>String sql= <span class="hljs-string">&quot;INSERT INTO websites1 VALUES(?,?,?,?,?)&quot;</span>;<br><br><span class="hljs-comment">//实例化 PreparedStatement</span><br>ps = conn.prepare<span class="hljs-constructor">Statement(<span class="hljs-params">sql</span>)</span>;<br><br><span class="hljs-comment">//传入参数，这里的参数来自于一个带有表单的jsp文件，很容易实现</span><br>ps.set<span class="hljs-constructor">String(1, <span class="hljs-params">request</span>.<span class="hljs-params">getParameter</span>(<span class="hljs-string">&quot;id&quot;</span>)</span>);<br>ps.set<span class="hljs-constructor">String(2, <span class="hljs-params">request</span>.<span class="hljs-params">getParameter</span>(<span class="hljs-string">&quot;name&quot;</span>)</span>);<br>ps.set<span class="hljs-constructor">String(3, <span class="hljs-params">request</span>.<span class="hljs-params">getParameter</span>(<span class="hljs-string">&quot;url&quot;</span>)</span>);<br>ps.set<span class="hljs-constructor">String(4, <span class="hljs-params">request</span>.<span class="hljs-params">getParameter</span>(<span class="hljs-string">&quot;alexa&quot;</span>)</span>);<br>ps.set<span class="hljs-constructor">String(5, <span class="hljs-params">request</span>.<span class="hljs-params">getParameter</span>(<span class="hljs-string">&quot;country&quot;</span>)</span>);<br><br><span class="hljs-comment">//执行数据库更新操作，不需要SQL语句</span><br>ps.execute<span class="hljs-constructor">Update()</span>;<br>sql = <span class="hljs-string">&quot;SELECT id, name, url FROM websites1&quot;</span>;<br>ps = conn.prepare<span class="hljs-constructor">Statement(<span class="hljs-params">sql</span>)</span>;<br><br><span class="hljs-comment">//获取查询结果</span><br>ResultSet rs = ps.execute<span class="hljs-constructor">Query()</span>;<br></code></pre></td></tr></table></figure>

<h2 id="Servlet文件的上传和下载"><a href="#Servlet文件的上传和下载" class="headerlink" title="Servlet文件的上传和下载"></a>Servlet文件的上传和下载</h2><p>文件上传：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">public <span class="hljs-keyword">class</span> UploadServlet extends HttpServlet &#123;<br><br>    <span class="hljs-keyword">private</span> static final long serialVersionUID = <span class="hljs-number">1l</span>;<br><br>    <span class="hljs-comment">// 上传文件存储的路径</span><br>    <span class="hljs-keyword">private</span> static final String UPLOAD_DIRECTORY = <span class="hljs-string">&quot;upload&quot;</span>;<br>    <span class="hljs-comment">// 上传配置</span><br>    <span class="hljs-keyword">private</span> static final <span class="hljs-built_in">int</span> MEMORY_THRESHOLD = <span class="hljs-number">1024</span><span class="hljs-operator"> * </span><span class="hljs-number">1024</span><span class="hljs-operator"> * </span><span class="hljs-number">3</span>;<br>    <span class="hljs-keyword">private</span> static final <span class="hljs-built_in">int</span> MAX_FILE_SIZE = <span class="hljs-number">1024</span><span class="hljs-operator"> * </span><span class="hljs-number">1024</span><span class="hljs-operator"> * </span><span class="hljs-number">40</span>;<br>    <span class="hljs-keyword">private</span> static final <span class="hljs-built_in">int</span> MAX_REQUEST_SIZE = <span class="hljs-number">1024</span><span class="hljs-operator"> * </span><span class="hljs-number">1024</span><span class="hljs-operator"> * </span><span class="hljs-number">50</span>;<br><br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Post(HttpServletRequest <span class="hljs-params">request</span>, HttpServletResponse <span class="hljs-params">response</span>)</span> throws ServletException, IOException &#123;<br>        <span class="hljs-comment">// 上传数据及保存文件</span><br>        <span class="hljs-comment">// 检测是否为多媒体上传</span><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ServletFileUpload</span>.</span></span>is<span class="hljs-constructor">MultipartContent(<span class="hljs-params">request</span>)</span>)&#123;<br>            <span class="hljs-comment">// 如果不是则停止</span><br>            PrintWriter writer = response.get<span class="hljs-constructor">Writer()</span>;<br>            writer.println(<span class="hljs-string">&quot;Error: 表单必须包含 enctype=multipart/form-data&quot;</span>);<br>            writer.flush<span class="hljs-literal">()</span>;<br>            return;<br>        &#125;<br>        <span class="hljs-comment">// 配置参数</span><br>        DiskFileItemFactory factory = <span class="hljs-keyword">new</span> <span class="hljs-constructor">DiskFileItemFactory()</span>;<br>        <span class="hljs-comment">// 设置内存临界值 - 超过该值之后将产生临时文件并存储于临时目录中</span><br>        factory.set<span class="hljs-constructor">SizeThreshold(MEMORY_THRESHOLD)</span>;<br>        <span class="hljs-comment">// 设置临时存储目录</span><br>        factory.set<span class="hljs-constructor">Repository(<span class="hljs-params">new</span> File(System.<span class="hljs-params">getProperty</span>(<span class="hljs-string">&quot;java.io.tmpdir&quot;</span>)</span>));<br><br>        ServletFileUpload upload = <span class="hljs-keyword">new</span> <span class="hljs-constructor">ServletFileUpload(<span class="hljs-params">factory</span>)</span>;<br><br>        <span class="hljs-comment">// 设置最大文件上传值</span><br>        upload.set<span class="hljs-constructor">FileSizeMax(MAX_FILE_SIZE)</span>;<br>        <span class="hljs-comment">// 设置最大请求值(包含文件和表单数据)</span><br>        upload.set<span class="hljs-constructor">SizeMax(MAX_REQUEST_SIZE)</span>;<br>        <span class="hljs-comment">// 中文处理</span><br>        upload.set<span class="hljs-constructor">HeaderEncoding(<span class="hljs-string">&quot;UTF-8&quot;</span>)</span>;<br><br>        <span class="hljs-comment">// 构造临时路径存储上传的文件</span><br>        <span class="hljs-comment">// 这个路径相对于当前应用的目录</span><br>        String uploadPath = request.get<span class="hljs-constructor">ServletContext()</span>.get<span class="hljs-constructor">RealPath(<span class="hljs-string">&quot;./&quot;</span>)</span> + <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">File</span>.</span></span>separator+ UPLOAD_DIRECTORY;<br><br>        <span class="hljs-comment">// 如果目录不存在则创建</span><br>        File uploadDir = <span class="hljs-keyword">new</span> <span class="hljs-constructor">File(<span class="hljs-params">uploadPath</span>)</span>;<br>        <span class="hljs-keyword">if</span> (!uploadDir.exists<span class="hljs-literal">()</span>)&#123;<br>            uploadDir.mkdirs<span class="hljs-literal">()</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 解析请求的内容提取文件数据</span><br>            List&lt;FileItem&gt; formItems = upload.parse<span class="hljs-constructor">Request(<span class="hljs-params">request</span>)</span>;<br>            <span class="hljs-keyword">if</span> (formItems != null<span class="hljs-operator"> &amp;&amp; </span>formItems.size<span class="hljs-literal">()</span> &gt; <span class="hljs-number">0</span>)&#123;<br>                <span class="hljs-comment">// 迭代表单数据</span><br>                <span class="hljs-keyword">for</span> (FileItem item:formItems)&#123;<br>                    <span class="hljs-comment">// 处理不在表单中的字段</span><br>                    <span class="hljs-keyword">if</span> (!item.is<span class="hljs-constructor">FormField()</span>)&#123;<br>                        String fileName = <span class="hljs-keyword">new</span> <span class="hljs-constructor">File(<span class="hljs-params">item</span>.<span class="hljs-params">getName</span>()</span>).get<span class="hljs-constructor">Name()</span>;<br>                        String filePath = uploadPath + <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">File</span>.</span></span>separator + fileName;<br>                        File storeFile = <span class="hljs-keyword">new</span> <span class="hljs-constructor">File(<span class="hljs-params">filePath</span>)</span>;<br>                        <span class="hljs-comment">// 在控制台输出文件的上传路径</span><br>                        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>out.println(filePath);<br>                        <span class="hljs-comment">// 保存文件到硬盘</span><br>                        item.write(storeFile);<br>                        request.set<span class="hljs-constructor">Attribute(<span class="hljs-string">&quot;message&quot;</span>,<span class="hljs-string">&quot;上传文件成功&quot;</span>)</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;catch (Exception ex)&#123;<br>            ex.print<span class="hljs-constructor">StackTrace()</span>;<br>            request.set<span class="hljs-constructor">Attribute(<span class="hljs-string">&quot;message&quot;</span>,<span class="hljs-string">&quot;错误信息&quot;</span>+<span class="hljs-params">ex</span>.<span class="hljs-params">getMessage</span>()</span>);<br>        &#125;<br>        <span class="hljs-comment">// 跳转到message.jsp文件中</span><br>        request.get<span class="hljs-constructor">ServletContext()</span>.get<span class="hljs-constructor">RequestDispatcher(<span class="hljs-string">&quot;/message.jsp&quot;</span>)</span>.forward(request,response);<br>    &#125;<br><br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(HttpServletRequest <span class="hljs-params">request</span>, HttpServletResponse <span class="hljs-params">response</span>)</span> throws ServletException, IOException &#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>文件上传upload.jsp</p>
<figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs erb"><span class="language-xml">&lt;%</span><span class="language-ruby">@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> </span><span class="language-xml">%&gt;</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>文件上传<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>文件上传实例<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;upload&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="language-xml">    选择一个文件：</span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;uploadFile&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;上传&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure>
<p>文件上传结果页message.jsp</p>
<figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs erb"><span class="language-xml">&lt;%</span><span class="language-ruby">@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> </span><span class="language-xml">%&gt;</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>文件上传结果<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>$&#123;message&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<p>上传文件结果<br><img src="/assets/JavaEE/javaweb_14.png" srcset="/img/loading.gif" lazyload alt="上传成功"><br>保存文件路径<br><img src="/assets/JavaEE/javaweb_15.png" srcset="/img/loading.gif" lazyload alt="保存路径"></p>
<p>文件下载<br>首先需要声明一个页面，当访问这个页面的时候，将所有可以下载的内容展示在网页上</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ListFilesServlet</span> extends HttpServlet &#123;<br><br>    <span class="hljs-comment">// 上传文件存储的路径</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> UPLOAD_DIRECTORY = <span class="hljs-string">&quot;upload&quot;</span>;<br><br>    @<span class="hljs-function">Override</span><br><span class="hljs-function">    <span class="hljs-keyword">protected</span> <span class="hljs-type">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> throws ServletException, IOException </span>&#123;<br>        <span class="hljs-comment">// 获取上传文件的目录</span><br>        <span class="hljs-type">String</span> uploadPath = request.<span class="hljs-built_in">getServletContext</span>().<span class="hljs-built_in">getRealPath</span>(<span class="hljs-string">&quot;./&quot;</span>) + <span class="hljs-built_in">File</span>.separator+ UPLOAD_DIRECTORY;<br>        <span class="hljs-comment">// 存储要下载的文件名称</span><br>        Map&lt;<span class="hljs-type">String</span>,<span class="hljs-type">String</span>&gt; fileNameMap = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>        <span class="hljs-comment">// 递归遍历filePath目录下的所有文件和目录</span><br>        <span class="hljs-built_in">listfile</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">File</span>(uploadPath),fileNameMap);<br>        <span class="hljs-comment">// 将Map集合发送listFile.jsp文件中</span><br>        request.<span class="hljs-built_in">setAttribute</span>(<span class="hljs-string">&quot;fileNameMap&quot;</span>,fileNameMap);<br>        request.<span class="hljs-built_in">getRequestDispatcher</span>(<span class="hljs-string">&quot;/listfile.jsp&quot;</span>).forward(request,response);<br>    &#125;<br><br>    @<span class="hljs-function">Override</span><br><span class="hljs-function">    <span class="hljs-keyword">protected</span> <span class="hljs-type">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> throws ServletException, IOException </span>&#123;<br>        <span class="hljs-built_in">doGet</span>(req,resp);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 遍历给定文件夹下的所有文件</span><br><span class="hljs-comment">     * @param file</span><br><span class="hljs-comment">     * @param map</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-type">void</span> <span class="hljs-title">listfile</span><span class="hljs-params">(<span class="hljs-built_in">File</span> file,Map&lt;<span class="hljs-type">String</span>,<span class="hljs-type">String</span>&gt; map)</span></span>&#123;<br>        <span class="hljs-comment">// 如果file代表的不是一个文件而是一个目录，则需要递归调用</span><br>        <span class="hljs-keyword">if</span> (!file.<span class="hljs-built_in">isFile</span>())&#123;<br>            <span class="hljs-comment">// 列出该目录下所有的文件和目录</span><br>            <span class="hljs-built_in">File</span>[] files = file.<span class="hljs-built_in">listFiles</span>();<br>            <span class="hljs-keyword">for</span> (<span class="hljs-built_in">File</span> f:files)&#123;<br>                <span class="hljs-built_in">listfile</span>(f,map);<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 获取到的文件名和对象直接放在Map集合中</span><br>            map.<span class="hljs-built_in">put</span>(file.<span class="hljs-built_in">getName</span>(),file.<span class="hljs-built_in">getName</span>());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>listfile.jsp</p>
<figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs erb"><span class="language-xml">&lt;%</span><span class="language-ruby">@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> </span><span class="language-xml">%&gt;</span><br><span class="language-xml">&lt;%</span><span class="language-ruby"><span class="hljs-variable">@taglib</span> prefix=<span class="hljs-string">&quot;c&quot;</span> uri=<span class="hljs-string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> </span><span class="language-xml">%&gt;</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>已经上传的文件列表<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">c:forEach</span> <span class="hljs-attr">var</span>=<span class="hljs-string">&quot;me&quot;</span> <span class="hljs-attr">items</span>=<span class="hljs-string">&quot;$&#123;fileNameMap&#125;&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">c:url</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;download&quot;</span> <span class="hljs-attr">var</span>=<span class="hljs-string">&quot;downurl&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">c:param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;filename&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;me.key&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">c:param</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">c:url</span>&gt;</span></span><br><span class="language-xml">    $&#123;me.value&#125;<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;$&#123;downurl&#125;&quot;</span>&gt;</span>下载<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">c:forEach</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<p>下载的Servlet</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">public <span class="hljs-keyword">class</span> DownloadServlet extends HttpServlet &#123;<br>    <span class="hljs-comment">// 上传文件存储的路径</span><br>    <span class="hljs-keyword">private</span> static final String UPLOAD_DIRECTORY = <span class="hljs-string">&quot;upload&quot;</span>;<br><br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Post(HttpServletRequest <span class="hljs-params">request</span>, HttpServletResponse <span class="hljs-params">response</span>)</span> throws ServletException, IOException &#123;<br>        <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(<span class="hljs-params">request</span>,<span class="hljs-params">response</span>)</span>;<br>    &#125;<br><br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(HttpServletRequest <span class="hljs-params">request</span>, HttpServletResponse <span class="hljs-params">response</span>)</span> throws ServletException, IOException &#123;<br>        String fileName = request.get<span class="hljs-constructor">Parameter(<span class="hljs-string">&quot;filename&quot;</span>)</span>;<br>        fileName = <span class="hljs-keyword">new</span> <span class="hljs-constructor">String(<span class="hljs-params">fileName</span>.<span class="hljs-params">getBytes</span>(<span class="hljs-string">&quot;iso8859-1&quot;</span>)</span>,<span class="hljs-string">&quot;UTF-8&quot;</span>);<br>        <span class="hljs-comment">// 上传的文件保存在固定的目录里</span><br>        String uploadPath = request.get<span class="hljs-constructor">ServletContext()</span>.get<span class="hljs-constructor">RealPath(<span class="hljs-string">&quot;./&quot;</span>)</span> + <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">File</span>.</span></span>separator+ UPLOAD_DIRECTORY;<br>        <span class="hljs-comment">// 得到需要下载的文件</span><br>        File file = <span class="hljs-keyword">new</span> <span class="hljs-constructor">File(<span class="hljs-params">uploadPath</span> +File.<span class="hljs-params">separator</span>+<span class="hljs-params">fileName</span>)</span>;<br>        <span class="hljs-comment">// 如果文件不存在</span><br>        <span class="hljs-keyword">if</span> (!file.exists<span class="hljs-literal">()</span>)&#123;<br>            request.set<span class="hljs-constructor">Attribute(<span class="hljs-string">&quot;message&quot;</span>,<span class="hljs-string">&quot;你想要下载的资源已被删除&quot;</span>)</span>;<br>            request.get<span class="hljs-constructor">RequestDispatcher(<span class="hljs-string">&quot;/message.jsp&quot;</span>)</span>.forward(request,response);<br>            return;<br>        &#125;<br>        <span class="hljs-comment">// 设置响应头</span><br>        response.set<span class="hljs-constructor">Header(<span class="hljs-string">&quot;content-disposition&quot;</span>,<span class="hljs-string">&quot;attachment;filename=&quot;</span>+ URLEncoder.<span class="hljs-params">encode</span>(<span class="hljs-params">fileName</span>,<span class="hljs-string">&quot;UTF-8&quot;</span>)</span>);<br>        <span class="hljs-comment">// 读取要下载的文件，保存到文件输入流中</span><br>        FileInputStream fis = <span class="hljs-keyword">new</span> <span class="hljs-constructor">FileInputStream(<span class="hljs-params">uploadPath</span> + File.<span class="hljs-params">separator</span>+<span class="hljs-params">fileName</span>)</span>;<br>        <span class="hljs-comment">// 创建输出流</span><br>        OutputStream os = response.get<span class="hljs-constructor">OutputStream()</span>;<br>        <span class="hljs-comment">// 设置缓冲区</span><br>        byte<span class="hljs-literal">[]</span> buffer = <span class="hljs-keyword">new</span> byte<span class="hljs-literal">[<span class="hljs-number">1024</span>]</span>;<br>        <span class="hljs-built_in">int</span> len = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> ((len = fis.read(buffer)) &gt; <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-comment">// 输出缓冲区的内容到浏览器，实现文件下载</span><br>            os.write(buffer,<span class="hljs-number">0</span>,len);<br>        &#125;<br>        <span class="hljs-comment">// 关闭文件输入流</span><br>        fis.close<span class="hljs-literal">()</span>;<br>        <span class="hljs-comment">// 关闭输出流</span><br>        os.close<span class="hljs-literal">()</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/assets/JavaEE/javaweb_16.png" srcset="/img/loading.gif" lazyload alt="文件列表"></p>
<h2 id="Servlet处理日期"><a href="#Servlet处理日期" class="headerlink" title="Servlet处理日期"></a>Servlet处理日期</h2><p>Servlet可以使用Java中大多数的方法，这也是Servlet的优势之一。<br>日期相关的常用方法：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>boolean after(Date date)</td>
<td>如果调用的Date对象中包含的日期在date指定日期之后返回true</td>
</tr>
<tr>
<td>boolean before(Date date)</td>
<td>如果调用的Date对象中包含的日期在date指定日期之前返回true</td>
</tr>
<tr>
<td>Object clone()</td>
<td>重复调用Data对象</td>
</tr>
<tr>
<td>int compareTo(Date date)</td>
<td>把调用对象的值与date值进行比较，如果调用对象在date之前返回负数，如果调用对象在datte之后返回正数，两者相同返回0</td>
</tr>
<tr>
<td>int compareTo(Object obj)</td>
<td>如果obj是Date类型，使用的方式同上</td>
</tr>
<tr>
<td>boolean equals(Object date)</td>
<td>如果调用的Date对象中包含的时间和日期与date指定的相同，返回true</td>
</tr>
<tr>
<td>long getTime()</td>
<td>返回毫秒数</td>
</tr>
<tr>
<td>int hashCode()</td>
<td>未调用返回哈希代码</td>
</tr>
<tr>
<td>void setTime(long time)</td>
<td>设置time指定的时间和日期，毫秒为单位</td>
</tr>
</tbody></table>
<p>例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DateServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HttpServlet</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>        doGet(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>        resp.setContentType(<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span>);<br>        <span class="hljs-type">PrintWriter</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> resp.getWriter();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">title</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;显示当前的日期和时间&quot;</span>;<br>        <span class="hljs-type">Date</span> <span class="hljs-variable">date</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();<br>        <span class="hljs-type">SimpleDateFormat</span> <span class="hljs-variable">sdf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">docType</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&lt;!DOCTYPE html&gt;\n&quot;</span>;<br>        out.println(docType +<br>                <span class="hljs-string">&quot;&lt;html&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;head&gt;&lt;title&gt;&quot;</span> + title + <span class="hljs-string">&quot;&lt;/title&gt;&lt;/head&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;body bgcolor=\&quot;#f0f0f0\&quot;&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;h1 align=\&quot;center\&quot;&gt;&quot;</span> + title + <span class="hljs-string">&quot;&lt;/h1&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;h2 align=\&quot;center\&quot;&gt;&quot;</span> + sdf.format(date) + <span class="hljs-string">&quot;&lt;/h2&gt;\n&quot;</span> +<br>                <span class="hljs-string">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/assets/JavaEE/javaweb_17.png" srcset="/img/loading.gif" lazyload alt="时间servlet运行结果"></p>
<h2 id="Servlet页面重定向"><a href="#Servlet页面重定向" class="headerlink" title="Servlet页面重定向"></a>Servlet页面重定向</h2><p>当文档移动到新的位置，我们需要向客户端发送这个新位置，我们需要用到网页重定向。当然也有可能是负载均衡，或者为了简单的随机，这些情况都有可能使用到网页重定向。</p>
<p>例子：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">public <span class="hljs-keyword">class</span> PageRedirectServlet extends HttpServlet &#123;<br><br>    @Override<br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Post(HttpServletRequest <span class="hljs-params">req</span>, HttpServletResponse <span class="hljs-params">resp</span>)</span> throws ServletException, IOException &#123;<br>        <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(<span class="hljs-params">req</span>,<span class="hljs-params">resp</span>)</span>;<br>    &#125;<br><br>    @Override<br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(HttpServletRequest <span class="hljs-params">req</span>, HttpServletResponse <span class="hljs-params">resp</span>)</span> throws ServletException, IOException &#123;<br>        <span class="hljs-comment">// 设置响应内容</span><br>        resp.set<span class="hljs-constructor">ContentType(<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span>)</span>;<br>        <span class="hljs-comment">// 设置重定向的位置</span><br>        String site = <span class="hljs-keyword">new</span> <span class="hljs-constructor">String(<span class="hljs-string">&quot;http://www.paulniu.com&quot;</span>)</span>;<br>        resp.set<span class="hljs-constructor">Status(<span class="hljs-params">resp</span>.SC_MOVED_TEMPORARILY)</span>;<br>        resp.set<span class="hljs-constructor">Header(<span class="hljs-string">&quot;Location&quot;</span>,<span class="hljs-params">site</span>)</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h1><p>本来想写在一个页面里面的，但是东西有点太多，所以分开多个博客书写</p>
<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/vmax-tam/p/4130589.html">Cookie和Session</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_36146275/article/details/55673211">登录Demo</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/JavaEE/">#JavaEE</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>JavaEE 03 JavaWeb基础(Servlet)</div>
      <div>http://example.com/2019/10/01/JavaEE-03-Servlet/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2019年10月1日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2019/10/08/mytools-01/" title="使用Vultr搭建SSR梯子">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">使用Vultr搭建SSR梯子</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2019/09/29/android-tools-19/" title="android奇技淫巧 19 高德地图/百度地图">
                        <span class="hidden-mobile">android奇技淫巧 19 高德地图/百度地图</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
